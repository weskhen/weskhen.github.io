<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>é¢æœå¤§æµ·,æƒ³ä»£ç </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="è¯æ˜æˆ‘ä¸€ä¸‹,æˆ‘è¿˜æ´»ç€...">
<meta property="og:type" content="website">
<meta property="og:title" content="é¢æœå¤§æµ·,æƒ³ä»£ç ">
<meta property="og:url" content="http://weskhen.xyz/index.html">
<meta property="og:site_name" content="é¢æœå¤§æµ·,æƒ³ä»£ç ">
<meta property="og:description" content="è¯æ˜æˆ‘ä¸€ä¸‹,æˆ‘è¿˜æ´»ç€...">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="é¢æœå¤§æµ·,æƒ³ä»£ç ">
<meta name="twitter:description" content="è¯æ˜æˆ‘ä¸€ä¸‹,æˆ‘è¿˜æ´»ç€...">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">

    <div id="header-title" class="inner">

      <h1 id="logo-wrap">
        <a href="/" id="logo">é¢æœå¤§æµ·,æƒ³ä»£ç </a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">æŒºå¥½çš„</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://weskhen.xyz"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-iOS13ç³»ç»Ÿé€‚é…" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/06/iOS13ç³»ç»Ÿé€‚é…/" class="article-date">
  <time datetime="2019-06-06T07:19:12.353Z" itemprop="datePublished">2019-06-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="iOS13-ç³»ç»Ÿé€‚é…"><a href="#iOS13-ç³»ç»Ÿé€‚é…" class="headerlink" title="iOS13 ç³»ç»Ÿé€‚é…"></a>iOS13 ç³»ç»Ÿé€‚é…</h2><p>å¾ˆè£å¹¸æˆ‘çš„iPhone7æ”¯æŒiOS13ç‰ˆæœ¬, å¹¶åœ¨è‹¹æœå‘å¸ƒåçš„ç¬¬ä¸€å¤©å°±é¢„è£…ä¸Šäº†,ç³»ç»Ÿéå¸¸æµç•…..å½“ç„¶ä¹Ÿæœ‰å¾ˆå¤šbugâ€¦</p>
<p>iOS13ç³»ç»Ÿæ”¯æŒçš„æœºå‹:</p>
<p>iPhone:  iphone SEã€iPhone 6Sã€iPhone6S Plusã€iphone 7ã€iphone 7s plusã€iphone 8ã€iphone8 plusã€iphone Xã€iphonexsã€iphone xs maxã€iphone XRâ€¦</p>
<p>iPad OSæ”¯æŒè®¾å¤‡åˆ—è¡¨ï¼šï¼ˆ12.9è‹±å¯¸ã€11è‹±å¯¸ã€10.5è‹±å¯¸ã€9.7è‹±å¯¸ï¼‰iPad Proã€ï¼ˆç¬¬äº”ä»£ã€ç¬¬å…­ä»£ï¼‰iPadã€iPad miniï¼ˆç¬¬äº”ä»£ï¼‰ã€iPad mini 4ã€iPad Air ï¼ˆç¬¬ä¸‰ä»£ï¼‰ã€iPad Air 2</p>
<h3 id="æš—é»‘æ¨¡å¼"><a href="#æš—é»‘æ¨¡å¼" class="headerlink" title="æš—é»‘æ¨¡å¼:"></a>æš—é»‘æ¨¡å¼:</h3><p>å¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯ç³»ç»Ÿå®Œæˆçš„</p>
<h4 id="é¢œè‰²æ”¯æŒ"><a href="#é¢œè‰²æ”¯æŒ" class="headerlink" title="é¢œè‰²æ”¯æŒ"></a>é¢œè‰²æ”¯æŒ</h4><p>å¯ä»¥æ ¹æ®å½“å‰æ¨¡å¼æ¥å±•ç¤º:</p>
<p>ocç‰ˆæœ¬</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (UIColor *)setElementLightStyleColor:(UIColor *)lColor darkStyleColor:(UIColor *)dColor &#123;</span><br><span class="line">    __block UIColor *showColor = lColor;</span><br><span class="line">    if (@available(iOS 13.0, *)) &#123;</span><br><span class="line">        showColor = [UIColor colorWithDynamicProvider:^UIColor * (UITraitCollection * dynamicProvider) &#123;</span><br><span class="line">            if (dynamicProvider.userInterfaceStyle == UIUserInterfaceStyleDark) &#123;</span><br><span class="line">                return  dColor;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                return lColor;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    return showColor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>swiftç‰ˆæœ¬</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> bgColor = <span class="type">UIColor</span> &#123; (traitCollection) -&gt; <span class="type">UIColor</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">switch</span> traitCollection.userInterfaceStyle &#123;</span><br><span class="line">    <span class="keyword">case</span> .light:</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIColor</span>.white</span><br><span class="line">    <span class="keyword">case</span> .dark:</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIColor</span>.black</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@interface UIColor (DynamicColors)</p>
<p>+ (UIColor <em>)colorWithDynamicProvider:(UIColor </em> (^)(UITraitCollection *))dynamicProvider API_AVAILABLE(ios(13.0), tvos(13.0)) API_UNAVAILABLE(watchos);</p>
<p>- (UIColor <em>)initWithDynamicProvider:(UIColor </em> (^)(UITraitCollection *))dynamicProvider API_AVAILABLE(ios(13.0), tvos(13.0)) API_UNAVAILABLE(watchos);</p>
<p>/* Resolve any color to its most fundamental form (a non-dynamic color) for a specific trait collection.</p>
<p> */</p>
<p>- (UIColor <em>)resolvedColorWithTraitCollection:(UITraitCollection </em>)traitCollection API_AVAILABLE(ios(13.0), tvos(13.0)) API_UNAVAILABLE(watchos);</p>
<p>@end</p>
<p>UITraitCollection ç±»ä¸­è·å–åˆ°å½“å‰æ¨¡å¼</p>
<p>@property (nonatomic, readonly) UIUserInterfaceStyle userInterfaceStyle API_AVAILABLE(tvos(10.0)) API_AVAILABLE(ios(12.0)) API_UNAVAILABLE(watchos); // unspecified: UIUserInterfaceStyleUnspecified</p>
<p>typedef NS_ENUM(NSInteger, UIUserInterfaceStyle) {</p>
<p>â€‹    UIUserInterfaceStyleUnspecified,</p>
<p>â€‹    UIUserInterfaceStyleLight,</p>
<p>â€‹    UIUserInterfaceStyleDark,</p>
<p>} API_AVAILABLE(tvos(10.0)) API_AVAILABLE(ios(12.0)) API_UNAVAILABLE(watchos);</p>
<h4 id="å›¾ç‰‡æ”¯æŒ"><a href="#å›¾ç‰‡æ”¯æŒ" class="headerlink" title="å›¾ç‰‡æ”¯æŒ:"></a>å›¾ç‰‡æ”¯æŒ:</h4><p>åªè¦åœ¨<code>.xcassets</code> ä¸­æŠŠå›¾ç‰‡æ‹–è¿›å»å,åœ¨å³ä¾§å·¥å…·æ ä¸­çš„æœ€åä¸€æ ,æŸ¥çœ‹<code>Appearances</code>,å¦‚å›¾:</p>
<p><a href><img src="http://ww1.sinaimg.cn/large/006tNc79ly1g3rfj0hohkj31cc0k048j.jpg" alt="image-20190606144105761"></a></p>
<h4 id="ä¸»åŠ¨è·å–å½“å‰æ¨¡å¼"><a href="#ä¸»åŠ¨è·å–å½“å‰æ¨¡å¼" class="headerlink" title="ä¸»åŠ¨è·å–å½“å‰æ¨¡å¼"></a>ä¸»åŠ¨è·å–å½“å‰æ¨¡å¼</h4><p>å¯ä»¥é€šè¿‡UIViewController æˆ– UIView ç±»ä¸­çš„traitCollectionå±æ€§æ¥è·å–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// self æ˜¯UIViewControllerçš„å­ç±»</span><br><span class="line">self.traitCollection.userInterfaceStyle;</span><br><span class="line"></span><br><span class="line">self.view.traitCollection.userInterfaceStyle;</span><br></pre></td></tr></table></figure>
<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>åœ¨æ›´æ–°åˆ°iOS13å,è¿«ä¸åŠå¾…çš„æ‰“å¼€äº†å„ä¸ªapp, å‘ç°å¾ˆå¤šappå¯¹å…¼å®¹æ€§æœ‰äº›é—®é¢˜, å¦‚å¾®ä¿¡çš„é¦–é¡µç­‰ç•Œé¢å¼‚å¸¸â€¦æ”¯ä»˜å®ä¸­å¾ˆå¤šé¡µé¢å“åº”ç¼“æ…¢â€¦,é—²é±¼é¦–é¡µæœç´¢å´©æºƒâ€¦ UCæµè§ˆå™¨çœŸæ˜¯ä¸ªç‰›é€¼çš„app,åœ¨æˆ‘è¿ç»­ç‚¹å‡»5,6æ¬¡,appä¸€æ‰“å¼€å°±crashä¹‹å,å®ƒå±…ç„¶å¯ä»¥å±•ç¤ºäº†â€¦<br><img src="http://ww2.sinaimg.cn/large/006tNc79ly1g3rj6ctd61j30ku1120uw.jpg" alt="iOS13ä¸‹çš„UCæµè§ˆå™¨é¦–é¡µ"><br>ä¸å¾—ä¸ä½©æœUCçš„å¼€å‘è€…ğŸ‚, ä¼°è®¡ç›´æ¥å¿½ç•¥äº†åŸå…ˆcrashçš„ä»£ç å—â€¦ </p>
<p>çœ‹äº†ä¸€ä¸‹ä¹‹å‰å…¬å¸,ä¸€æ‰‹å…»å¤§çš„å¨ƒâ€¦ å®Œç¾å…¼å®¹iOS13,å¿ƒä¸­æœ‰ç‚¹å°å…´å¥‹â€¦</p>
<p>ä¸ºä»€ä¹ˆä¼šUIå¼‚å¸¸,æˆ–ç›´æ¥crashå‘¢? æˆ‘çŒœå¤§éƒ¨åˆ†åº”è¯¥æ˜¯å¼€å‘è€…åŠ¨äº†iOSç§æœ‰API,æ¥å®ç°ä¸€äº›å®šåˆ¶åŒ–éœ€æ±‚â€¦ å› ä¸ºappleä¸ä¼šè€ƒè™‘å…¼å®¹è¿™äº›ä¸œè¥¿,å› ä¸ºå®ƒæœ¬æ¥å°±ä¸æƒ³ç»™ä½ ç”¨,è‡ªå·±ä½œæ­»åˆæœ‰ä»€ä¹ˆåŠæ³•â€¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">/*!</span><br><span class="line"> * è·å–å½“å‰ç½‘ç»œç±»å‹</span><br><span class="line"> * é€šè¿‡statusBarçš„ç½‘ç»œsubviewè·å–å…·ä½“ç±»å‹</span><br><span class="line"> */</span><br><span class="line">+ (NETWORK_TYPE)getNetworkTypeFromStatusBar</span><br><span class="line">&#123;</span><br><span class="line">    UIApplication *app = [UIApplication sharedApplication];</span><br><span class="line">    NETWORK_TYPE nettype = NETWORK_TYPE_NONE;</span><br><span class="line">    //iOS11</span><br><span class="line">    if ([[app valueForKeyPath:@&quot;_statusBar&quot;] isKindOfClass:NSClassFromString(@&quot;UIStatusBar_Modern&quot;)]) &#123;</span><br><span class="line">        NSArray *views = [[[[app valueForKeyPath:@&quot;statusBar&quot;] valueForKeyPath:@&quot;statusBar&quot;] valueForKeyPath:@&quot;foregroundView&quot;] subviews];</span><br><span class="line">        for (UIView *view in views) &#123;</span><br><span class="line">            for (id child in view.subviews) &#123;</span><br><span class="line">                //wifi</span><br><span class="line">                if ([child isKindOfClass:NSClassFromString(@&quot;_UIStatusBarWifiSignalView&quot;)]) &#123;</span><br><span class="line">                    nettype = NETWORK_TYPE_WIFI;</span><br><span class="line">                &#125;</span><br><span class="line">                //2G 3G 4G</span><br><span class="line">                if ([child isKindOfClass:NSClassFromString(@&quot;_UIStatusBarStringView&quot;)]) &#123;</span><br><span class="line">                    if ([[child valueForKey:@&quot;_originalText&quot;] containsString:@&quot;2G&quot;]) &#123;</span><br><span class="line">                        nettype = NETWORK_TYPE_2G;</span><br><span class="line">                    &#125; else if ([[child valueForKey:@&quot;_originalText&quot;] containsString:@&quot;3G&quot;]) &#123;</span><br><span class="line">                        nettype = NETWORK_TYPE_3G;</span><br><span class="line">                    &#125; else if ([[child valueForKey:@&quot;_originalText&quot;] containsString:@&quot;4G&quot;]) &#123;</span><br><span class="line">                        nettype = NETWORK_TYPE_4G;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        NSArray *subviews = [[[[UIApplication sharedApplication] valueForKey:@&quot;statusBar&quot;]</span><br><span class="line">                              valueForKey:@&quot;foregroundView&quot;] subviews];</span><br><span class="line">        NSNumber *dataNetworkItemView = nil;</span><br><span class="line">        for (id subview in subviews) &#123;</span><br><span class="line">            if ([subview isKindOfClass:[NSClassFromString(@&quot;UIStatusBarDataNetworkItemView&quot;) class]]) &#123;</span><br><span class="line">                dataNetworkItemView = subview;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        NSNumber *num = [dataNetworkItemView valueForKey:@&quot;dataNetworkType&quot;];</span><br><span class="line">        nettype = [num intValue];</span><br><span class="line">    &#125;</span><br><span class="line">   return nettype;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šæ‰€ç¤º, è‹¹æœæä¾›çš„APIä¸­æ²¡æœ‰ç›´æ¥ç»™å‡º<code>_UIStatusBarWifiSignalView</code>è¿™ä¸€ç±»å,æˆ‘ä»¬å¼€å‘è€…è‡ªå·±é€šè¿‡åç¼–è¯‘,æˆ–UIå…ƒç´ æŸ¥çœ‹å™¨ä¸­å‘ç°äº†è¿™äº›ç§æœ‰çš„ç±»å,åˆ©ç”¨å®ƒå¯ä»¥è§£å†³æˆ‘ä»¬ä¸€äº›å¥‡æ€ªçš„éœ€æ±‚,ä½†ä»£ä»·ä¹Ÿæ˜¯æœ‰çš„, æ‰€ä»¥èƒ½ä¸ä½¿ç”¨ç§æœ‰APIå°½é‡ä¸è¦ä½¿ç”¨,ä»¥é˜²ä¸æµ‹â€¦ æ„Ÿè§‰iOSå®¡æ ¸ç§æœ‰APIè¿˜æ˜¯æœ‰é“ç†çš„â€¦</p>
<h3 id="so"><a href="#so" class="headerlink" title="so"></a>so</h3><p>ä¸ªäººæ„Ÿè§‰iOS13è¿˜æ˜¯ä¸€ä¸ªæ¯”è¾ƒç¨³ç‰ˆæœ¬,ç³»ç»Ÿå¾ˆé¡ºç•…,ç›®å‰æœ‰äº›å°bugä¹Ÿæ¯”è¾ƒæ­£å¸¸. å¾ˆå¤šå°åŠŸèƒ½ä¹Ÿæ¯”è¾ƒå¸å¼•äºº,å¦‚å¯ä»¥å®šåˆ¶ä¸ªæ€§åŒ–çš„Memojiè¡¨æƒ…,æŸ¥æ‰¾(æŸ¥æ‰¾æˆ‘çš„æœ‹å‹å’ŒæŸ¥æ‰¾æˆ‘çš„iPhone)åŠŸèƒ½,ç…§ç‰‡åŠŸèƒ½å‡çº§ã€ç‚«é…·çš„é”®ç›˜æ»‘åŠ¨è¾“å…¥ç­‰ç­‰â€¦</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2019/06/06/iOS13ç³»ç»Ÿé€‚é…/" data-id="cjwkgb27t000alpzb13ivczaa" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>




  
    <article id="post-é˜¿é‡Œäº‘æ—¥å¿—ä¸Šä¼ åŠæ— ç—•åŸ‹ç‚¹" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/22/é˜¿é‡Œäº‘æ—¥å¿—ä¸Šä¼ åŠæ— ç—•åŸ‹ç‚¹/" class="article-date">
  <time datetime="2019-05-21T16:00:00.000Z" itemprop="datePublished">2019-05-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/22/é˜¿é‡Œäº‘æ—¥å¿—ä¸Šä¼ åŠæ— ç—•åŸ‹ç‚¹/">æ— ç—•åŸ‹ç‚¹åŠä¸ŠæŠ¥é˜¿é‡Œäº‘æ—¥å¿—</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><p>è¯¥é¡¹ç›®ä¸»è¦æä¾›äº†æ— ç—•åŸ‹ç‚¹çš„åŠŸèƒ½,æœ‰å…³æ— ç—•åŸ‹ç‚¹ æ–‡ç« åº”è¯¥æœ‰ä¸€å¤§å †,è¿™è¾¹ä¸åšé˜è¿°.åŸ‹ç‚¹æ²¡æœ‰è¦†ç›–å…¨éƒ¨äº‹ä»¶,åªå¯¹ä¸€äº›ç®€å•å¸¸ç”¨çš„å¤„ç†äº†,åæœŸéœ€æ±‚å¯¹å…·ä½“çš„ä¸šåŠ¡æ‰©å¼ å¯¹è±¡(Model)</p>
<p>å…¶æ¬¡,é¡¹ç›®ä¹Ÿæä¾›äº†ç›®å‰æ¯”è¾ƒæµè¡Œçš„é˜¿é‡Œäº‘æ—¥å¿—ä¸ŠæŠ¥åŠŸèƒ½, ä¸ŠæŠ¥æ ¼å¼æ”¯æŒjsonå’Œprotocol bufferæ ¼å¼.</p>
<h5 id="protocol-æ–‡ä»¶è½¬objc"><a href="#protocol-æ–‡ä»¶è½¬objc" class="headerlink" title=".protocol æ–‡ä»¶è½¬objc"></a>.protocol æ–‡ä»¶è½¬objc</h5><p>  Sls.pbobjc.hå’ŒSls.pbobjc.m æ–‡ä»¶çš„å¯¼å‡º:</p>
<ol>
<li><p>é¦–é¡µéœ€è¦å®‰è£…protocç‰ˆæœ¬:</p>
<p>å¯ç½‘ä¸Šè‡ªè¡Œä¸‹è½½:å¦‚æˆ‘ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯protoc-3.0.0.</p>
<p>å®‰è£…proto ç‰ˆæœ¬protoc-3.0.0-osx-x86_64,å°†è¯¥binæ–‡ä»¶ä¸‹çš„protoc  æ”¾å…¥åˆ°/usr/local/bin/ </p>
</li>
</ol>
<ol start="2">
<li><p>protocæ–‡ä»¶è½¬objc</p>
<ol>
<li>cdåˆ°å½“å‰ç›®å½•ä¸‹,æ‰§è¡Œå‘½ä»¤è¡Œ </li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protoc sls.proto --objc_out=&quot;./&quot;</span><br></pre></td></tr></table></figure>
<p>ä¼šåœ¨å½“å‰çš„æ–‡ä»¶ä¸‹å¤šå¤„ä¸¤ä¸ªæ–‡ä»¶.</p>
<p>å¯èƒ½ä¼šæœ‰è­¦å‘Š,å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[libprotobuf WARNING google/protobuf/compiler/parser.cc:547] No syntax specified for the proto file: sls.proto. Please use &apos;syntax = &quot;proto2&quot;;&apos; or &apos;syntax = &quot;proto3&quot;;&apos; to specify a syntax version. (Defaulted to proto2 syntax.)</span><br></pre></td></tr></table></figure>
<p>è¯´æ˜éœ€è¦æŒ‡å®šprotocç‰ˆæœ¬,å¦‚æœæ–‡ä»¶å¯¼å‡ºæˆåŠŸ æ­¤å¤„å¯å¿½ç•¥.</p>
<p>åœ¨sls.protoæ–‡ä»¶ä¸­çš„ç¬¬ä¸€è¡Œæ’å…¥ </p>
<p><code>syntax = &quot;proto2&quot;;</code>æˆ–<code>syntax = &quot;proto3&quot;;</code></p>
</li>
</ol>
<h4 id="è½¯ä»¶æ¶æ„"><a href="#è½¯ä»¶æ¶æ„" class="headerlink" title="è½¯ä»¶æ¶æ„"></a>è½¯ä»¶æ¶æ„</h4><p>è½¯ä»¶æ¶æ„è¯´æ˜</p>
<h4 id="å®‰è£…æ•™ç¨‹"><a href="#å®‰è£…æ•™ç¨‹" class="headerlink" title="å®‰è£…æ•™ç¨‹"></a>å®‰è£…æ•™ç¨‹</h4><ol>
<li>æ”¯æŒpod <code>pod  &#39;BuryingPoint&#39;</code></li>
</ol>
<h4 id="ä½¿ç”¨è¯´æ˜"><a href="#ä½¿ç”¨è¯´æ˜" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h4><ol>
<li><p>podå®‰è£…å. åœ¨BuryingPointAliLogConst.h ä¸­æœ‰éœ€è¦ä¿®æ”¹çš„é˜¿é‡Œäº‘æ—¥å¿—ç›¸å…³çš„é…ç½®é¡¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - ä»¥ä¸‹éœ€è¦æ ¹æ®é˜¿é‡Œäº‘é…ç½®é¡¹èµ‹å€¼</span><br><span class="line">static NSString * AliLogDefaultEndPoint = @&quot;&quot;; //cn-hangzhou.log.aliyuncs.com</span><br><span class="line">static NSString * AliLogDefaultProject = @&quot;&quot;;</span><br><span class="line">static NSString * AliLogDefaultAccessKeyID = @&quot;&quot;;</span><br><span class="line">static NSString * AliLogDefaultAccessKeySecret = @&quot;&quot;;</span><br><span class="line">static NSString * AliLogDefaultLogstores = @&quot;&quot;;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä½¿ç”¨å‰èµ‹å€¼.</p>
</li>
<li><p>åŸ‹ç‚¹äº‹ä»¶å¯ä»¥ç»§æ‰¿<code>BuryingPointBaseModel</code>,æ·»åŠ å„ç§æ—¥å¿—äº‹ä»¶ç±»å‹.</p>
</li>
<li><p>æä¾›äº†ä¸ŠæŠ¥äº‹ä»¶çš„å…¥å£</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/// æ ¹æ®ä¸ŠæŠ¥ç­–ç•¥ ä¸ŠæŠ¥åŸ‹ç‚¹</span><br><span class="line">- (void)handleEventLogWithModel:(BuryingPointBaseModel *)model strategy:(BPLogUploadStrategy)strategy;</span><br><span class="line"></span><br><span class="line">/// æ ¡éªŒæ‰€æœ‰åŸ‹ç‚¹æ•°æ®ç«‹å³ä¸Šä¼ </span><br><span class="line">- (void)checkUploadBuryingPointImmediately;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><p> æºç åœ°å€: <a href="https://github.com/weskhen/BuryingPoint" target="_blank" rel="noopener">https://github.com/weskhen/BuryingPoint</a><br>æ¬¢è¿æ²Ÿé€šäº¤æµâ€¦.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2019/05/22/é˜¿é‡Œäº‘æ—¥å¿—ä¸Šä¼ åŠæ— ç—•åŸ‹ç‚¹/" data-id="cjwkgb28a000slpzbye59mtvw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/åŸ‹ç‚¹/">åŸ‹ç‚¹</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/é˜¿é‡Œäº‘æ—¥å¿—/">é˜¿é‡Œäº‘æ—¥å¿—</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-NSNumberFormatter" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/23/NSNumberFormatter/" class="article-date">
  <time datetime="2019-02-22T16:00:00.000Z" itemprop="datePublished">2019-02-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/23/NSNumberFormatter/">NSNumberFormatterçš„ç®€å•ä½¿ç”¨</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>NSNumber</li>
</ul>
<p>â€‹    æ•°å­—ç±»ï¼ŒiOSä¸“é—¨å°è£…èµ·æ¥ç”¨äºæ•°å­—çš„å¤„ç†ï¼Œå¯ä»¥ç”¨stringã€doubleã€floatåˆå§‹åŒ–</p>
<ul>
<li><p>NSNumberFormatter</p>
<p>æ•°å­—æ ¼å¼ç±»ï¼Œç”¨äºå®šä¹‰æ•°å­—çš„æ ¼å¼</p>
</li>
</ul>
<p>NSNumberFormatterçš„ä½¿ç”¨:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];</span><br><span class="line">[formatter setFormatterBehavior:NSFoundationVersionNumber10_4];</span><br><span class="line">[formatter setNumberStyle:NSNumberFormatterScientificStyle];</span><br><span class="line">[formatter setFormatWidth:9]; // set width</span><br><span class="line">[formatter setPaddingCharacter:@&quot;x&quot;]; // bu</span><br><span class="line">NSString *convertNumber = [formatter stringFromNumber:number];</span><br></pre></td></tr></table></figure>
<p>setFormatterBehaviorè¿™ä¸ªè®¾ç½®å’Œç‰ˆæœ¬æœ‰å…³ç³»ï¼Œä¸€èˆ¬ä¸ç”¨è®¾ç½®ï¼Œä¸ç”¨è¿™ä¸ªå‡½æ•°ä¹Ÿå¯ä»¥ï¼›<br>setNumberStyleè®¾ç½®æ–‡æœ¬æ˜¾ç¤ºçš„æ ¼å¼ï¼Œæ˜¯ä¸ªæšä¸¾ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">typedef NS_ENUM(NSUInteger, NSNumberFormatterStyle) &#123;</span><br><span class="line">    NSNumberFormatterNoStyle = kCFNumberFormatterNoStyle, //æ— æ ¼å¼</span><br><span class="line">    NSNumberFormatterDecimalStyle = kCFNumberFormatterDecimalStyle, // åè¿›åˆ¶æ ¼å¼</span><br><span class="line">    NSNumberFormatterCurrencyStyle = kCFNumberFormatterCurrencyStyle, // å½“å‰ç³»ç»Ÿè´§å¸æ ¼å¼(å¦‚æœæ˜¯ä¸­æ–‡å°±æ˜¯Â¥)</span><br><span class="line">    NSNumberFormatterPercentStyle = kCFNumberFormatterPercentStyle, // ç™¾åˆ†æ•°æ ¼å¼</span><br><span class="line">    NSNumberFormatterScientificStyle = kCFNumberFormatterScientificStyle, //ç§‘å­¦æŠ€æœ¯æ³•æ ¼å¼</span><br><span class="line">    NSNumberFormatterSpellOutStyle = kCFNumberFormatterSpellOutStyle, // é˜¿æ‹‰ä¼¯æ•°å­—è½¬æ¢ä¸ºæ–‡å­—çš„æ ¼å¼,ä¾‹å¦‚â€œ23â€ becomes â€œtwenty-threeâ€ â€œ23â€å˜ä¸º äºŒä¸‰</span><br><span class="line">    NSNumberFormatterOrdinalStyle API_AVAILABLE(macos(10.11), ios(9.0), watchos(2.0), tvos(9.0)) = kCFNumberFormatterOrdinalStyle, //ä¸­æ–‡:ç¬¬12,3456 è‹±æ–‡:12,3456th</span><br><span class="line">    NSNumberFormatterCurrencyISOCodeStyle API_AVAILABLE(macos(10.11), ios(9.0), watchos(2.0), tvos(9.0)) = kCFNumberFormatterCurrencyISOCodeStyle,// USD 123,456.02</span><br><span class="line">    NSNumberFormatterCurrencyPluralStyle API_AVAILABLE(macos(10.11), ios(9.0), watchos(2.0), tvos(9.0)) = kCFNumberFormatterCurrencyPluralStyle,// 123,456.02ç¾å…ƒ</span><br><span class="line">    NSNumberFormatterCurrencyAccountingStyle API_AVAILABLE(macos(10.11), ios(9.0), watchos(2.0), tvos(9.0)) = kCFNumberFormatterCurrencyAccountingStyle,//// US$123,456.02</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>setFormatWidthè®¾ç½®å­—ç¬¦å®½åº¦</p>
<p>setPaddingCharacterè®¾ç½®å¡«å……å­—å¹•ï¼šæ¯”å¦‚ä½ è®¾ç½®çš„å®½åº¦ä¸º9ï¼Œç»“æœæ•°å­—åªæœ‰3ä½ï¼Œå…¶å®ƒçš„6ä½ç”¨è¿™ä¸ªå‡½æ•°è®¾ç½®çš„å­—æ¯å¡«å……ã€‚</p>
<p>zeroSymbol: é›¶çš„æ ·å¼</p>
<p>paddingPosition:å¡«å……ä½ç½®</p>
<p>positiveSuffix: </p>
<p>maximumIntegerDigits:æ•´æ•°æœ€å¤šä½æ•°</p>
<p>minimumIntegerDigits:æ•´æ•°æœ€å°‘ä½æ•°</p>
<p>maximumFractionDigits:å°æ•°ä½æœ€å¤šä½æ•°</p>
<p>minimumFractionDigits:å°æ•°ä½æœ€å°‘ä½æ•°</p>
<p>groupingSize:æ•°å­—åˆ†å‰²çš„å°ºå¯¸</p>
<p>secondaryGroupingSize:é™¤äº†groupingSizeå†³å®šçš„å°ºå¯¸å¤–,å…¶ä»–æ•°å­—ä½åˆ†å‰²çš„å°ºå¯¸</p>
<p>maximumSignificantDigits:æœ€å¤§æœ‰æ•ˆæ•°å­—ä¸ªæ•°</p>
<p>minimumSignificantDigits:æœ€å°‘æœ‰æ•ˆæ•°å­—ä¸ªæ•°</p>
<p>roundingIncrement:èˆå…¥å€¼,æ¯”å¦‚ä»¥10ä¸ºè¿›ä½å€¼,é‚£ä¹ˆ156å°±è¿›ä½ä¸º160,154è¿›ä½ä¸º150</p>
<p>æ–¹æ³•:setPositiveFormat</p>
<p>è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// åŸå§‹çš„æ•°å­—ä¸º677789.98</span><br><span class="line">[numberFormatter setPositiveFormat:@&quot;.00;â€]//è¾“å‡ºï¼š677789.98</span><br><span class="line">[numberFormatter setPositiveFormat:@â€œ0%;â€]//è¾“å‡ºï¼š67778998%</span><br><span class="line">[numberFormatter setPositiveFormat:@â€œ0.00%;â€]//è¾“å‡ºï¼š67778998.00%</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2019/02/23/NSNumberFormatter/" data-id="cjwkgb27j0001lpzb6l0i29as" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NSNumberFormatter/">NSNumberFormatter</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-MSLã€TTLå’ŒRTTç®€ä»‹" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/23/MSLã€TTLå’ŒRTTç®€ä»‹/" class="article-date">
  <time datetime="2019-02-22T16:00:00.000Z" itemprop="datePublished">2019-02-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/ç½‘ç»œ/">ç½‘ç»œ</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/23/MSLã€TTLå’ŒRTTç®€ä»‹/">MSLã€TTLå’ŒRTTç®€ä»‹</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>1ã€MSLæ˜¯Maximum Segment Lifetimeè‹±æ–‡çš„ç¼©å†™ï¼Œä¸­æ–‡å¯ä»¥è¯‘ä¸ºâ€œæŠ¥æ–‡æœ€å¤§ç”Ÿå­˜æ—¶é—´â€ï¼Œä»–æ˜¯ä»»ä½•æŠ¥æ–‡åœ¨ç½‘ç»œä¸Šå­˜åœ¨çš„æœ€é•¿æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´æŠ¥æ–‡å°†è¢«ä¸¢å¼ƒã€‚å› ä¸ºtcpæŠ¥æ–‡ï¼ˆsegmentï¼‰æ˜¯ipæ•°æ®æŠ¥ï¼ˆdatagramï¼‰çš„æ•°æ®éƒ¨åˆ†ï¼Œå…·ä½“ç§°è°“è¯·å‚è§ã€Šæ•°æ®åœ¨ç½‘ç»œå„å±‚ä¸­çš„ç§°å‘¼ã€‹ä¸€æ–‡ï¼Œ</p>
<p>2ã€è€Œipå¤´ä¸­æœ‰ä¸€ä¸ªTTLåŸŸï¼ŒTTLæ˜¯time to liveçš„ç¼©å†™ï¼Œä¸­æ–‡å¯ä»¥è¯‘ä¸ºâ€œç”Ÿå­˜æ—¶é—´â€ï¼Œè¿™ä¸ªç”Ÿå­˜æ—¶é—´æ˜¯ç”±æºä¸»æœºè®¾ç½®åˆå§‹å€¼ä½†ä¸æ˜¯å­˜çš„å…·ä½“æ—¶é—´ï¼Œè€Œæ˜¯å­˜å‚¨äº†ä¸€ä¸ªipæ•°æ®æŠ¥å¯ä»¥ç»è¿‡çš„æœ€å¤§è·¯ç”±æ•°ï¼Œæ¯ç»è¿‡ä¸€ä¸ªå¤„ç†ä»–çš„è·¯ç”±å™¨æ­¤å€¼å°±å‡1ï¼Œå½“æ­¤å€¼ä¸º0åˆ™æ•°æ®æŠ¥å°†è¢«ä¸¢å¼ƒï¼ŒåŒæ—¶å‘é€ICMPæŠ¥æ–‡é€šçŸ¥æºä¸»æœºã€‚RFC 793ä¸­è§„å®šMSLä¸º2åˆ†é’Ÿï¼Œå®é™…åº”ç”¨ä¸­å¸¸ç”¨çš„æ˜¯30ç§’ï¼Œ1åˆ†é’Ÿå’Œ2åˆ†é’Ÿç­‰ã€‚</p>
<p>â€‹     2MSLå³ä¸¤å€çš„MSLï¼ŒTCPçš„TIME_WAITçŠ¶æ€ä¹Ÿç§°ä¸º2MSLç­‰å¾…çŠ¶æ€ï¼Œå½“TCPçš„ä¸€ç«¯å‘èµ·ä¸»åŠ¨å…³é—­ï¼Œåœ¨å‘å‡ºæœ€åä¸€ä¸ªACKåŒ…åï¼Œå³ç¬¬3æ¬¡æ¡æ‰‹å®Œæˆåå‘é€äº†ç¬¬å››æ¬¡æ¡æ‰‹çš„ACKåŒ…åå°±è¿›å…¥äº†TIME_WAITçŠ¶æ€ï¼Œå¿…é¡»åœ¨æ­¤çŠ¶æ€ä¸Šåœç•™ä¸¤å€çš„MSLæ—¶é—´ï¼Œç­‰å¾…2MSLæ—¶é—´ä¸»è¦ç›®çš„æ˜¯æ€•æœ€åä¸€ä¸ªACKåŒ…å¯¹æ–¹æ²¡æ”¶åˆ°ï¼Œé‚£ä¹ˆå¯¹æ–¹åœ¨è¶…æ—¶åå°†é‡å‘ç¬¬ä¸‰æ¬¡æ¡æ‰‹çš„FINåŒ…ï¼Œä¸»åŠ¨å…³é—­ç«¯æ¥åˆ°é‡å‘çš„FINåŒ…åå¯ä»¥å†å‘ä¸€ä¸ªACKåº”ç­”åŒ…ã€‚åœ¨TIME_WAITçŠ¶æ€æ—¶ä¸¤ç«¯çš„ç«¯å£ä¸èƒ½ä½¿ç”¨ï¼Œè¦ç­‰åˆ°2MSLæ—¶é—´ç»“æŸæ‰å¯ç»§ç»­ä½¿ç”¨ã€‚å½“è¿æ¥å¤„äº2MSLç­‰å¾…é˜¶æ®µæ—¶ä»»ä½•è¿Ÿåˆ°çš„æŠ¥æ–‡æ®µéƒ½å°†è¢«ä¸¢å¼ƒã€‚ä¸è¿‡åœ¨å®é™…åº”ç”¨ä¸­å¯ä»¥é€šè¿‡è®¾ç½®SO_REUSEADDRé€‰é¡¹è¾¾åˆ°ä¸å¿…ç­‰å¾…2MSLæ—¶é—´ç»“æŸå†ä½¿ç”¨æ­¤ç«¯å£ã€‚</p>
<p>â€‹    TTLä¸MSLæ˜¯æœ‰å…³ç³»çš„ä½†ä¸æ˜¯ç®€å•çš„ç›¸ç­‰çš„å…³ç³»ï¼ŒMSLè¦å¤§äºç­‰äºTTLã€‚</p>
<p> 3ã€ RTTæ˜¯å®¢æˆ·åˆ°æœåŠ¡å™¨å¾€è¿”æ‰€èŠ±æ—¶é—´ï¼ˆround-trip timeï¼Œç®€ç§°RTTï¼‰ï¼ŒTCPå«æœ‰åŠ¨æ€ä¼°ç®—RTTçš„ç®—æ³•ã€‚TCPè¿˜æŒç»­ä¼°ç®—ä¸€ä¸ªç»™å®šè¿æ¥çš„RTTï¼Œè¿™æ˜¯å› ä¸ºRTTå—ç½‘ç»œä¼ è¾“æ‹¥å¡ç¨‹åºçš„å˜åŒ–è€Œå˜åŒ–</p>
<p>4ã€ 2MSLå³ä¸¤å€çš„MSLï¼ŒTCPçš„TIME_WAITçŠ¶æ€ä¹Ÿç§°ä¸º2MSLç­‰å¾…çŠ¶æ€ï¼Œå½“TCPçš„ä¸€ç«¯å‘èµ·ä¸»åŠ¨å…³é—­ï¼Œåœ¨å‘å‡ºæœ€åä¸€ä¸ªACKåŒ…åï¼Œå³ç¬¬3æ¬¡æ¡ æ‰‹å®Œæˆåå‘é€äº†ç¬¬å››æ¬¡æ¡æ‰‹çš„ACKåŒ…åå°±è¿›å…¥äº†TIME_WAITçŠ¶æ€ï¼Œå¿…é¡»åœ¨æ­¤çŠ¶æ€ä¸Šåœç•™ä¸¤å€çš„MSLæ—¶é—´ï¼Œç­‰å¾…2MSLæ—¶é—´ä¸»è¦ç›®çš„æ˜¯æ€•æœ€åä¸€ä¸ª ACKåŒ…å¯¹æ–¹æ²¡æ”¶åˆ°ï¼Œé‚£ä¹ˆå¯¹æ–¹åœ¨è¶…æ—¶åå°†é‡å‘ç¬¬ä¸‰æ¬¡æ¡æ‰‹çš„FINåŒ…ï¼Œä¸»åŠ¨å…³é—­ç«¯æ¥åˆ°é‡å‘çš„FINåŒ…åå¯ä»¥å†å‘ä¸€ä¸ªACKåº”ç­”åŒ…ã€‚åœ¨TIME_WAITçŠ¶æ€ æ—¶ä¸¤ç«¯çš„ç«¯å£ä¸èƒ½ä½¿ç”¨ï¼Œè¦ç­‰åˆ°2MSLæ—¶é—´ç»“æŸæ‰å¯ç»§ç»­ä½¿ç”¨ã€‚å½“è¿æ¥å¤„äº2MSLç­‰å¾…é˜¶æ®µæ—¶ä»»ä½•è¿Ÿåˆ°çš„æŠ¥æ–‡æ®µéƒ½å°†è¢«ä¸¢å¼ƒã€‚ä¸è¿‡åœ¨å®é™…åº”ç”¨ä¸­å¯ä»¥é€šè¿‡è®¾ç½® SO_REUSEADDRé€‰é¡¹è¾¾åˆ°ä¸å¿…ç­‰å¾…2MSLæ—¶é—´ç»“æŸå†ä½¿ç”¨æ­¤ç«¯å£ã€‚å¯¹äºTCPä¸­çš„å„ç§æ§åˆ¶å­—æ®µï¼Œæ¥ä¸‹æ¥è¿›è¡Œå…·ä½“è¯´æ˜ã€‚</p>
<p>äºŒã€TCPæ§åˆ¶å­—æ®µæ ‡å¿—ï¼šURGã€ACKã€PSHã€RSTã€SYNã€FIN</p>
<p>åœ¨TCPå±‚ï¼Œæœ‰ä¸ªFLAGSå­—æ®µï¼Œè¿™ä¸ªå­—æ®µæœ‰ä»¥ä¸‹å‡ ä¸ªæ ‡è¯†ï¼šSYN, FIN, ACK, PSH, RST, URG.<br>å…¶ä¸­ï¼Œå¯¹äºæˆ‘ä»¬æ—¥å¸¸çš„åˆ†ææœ‰ç”¨çš„å°±æ˜¯å‰é¢çš„äº”ä¸ªå­—æ®µã€‚</p>
<p>å®ƒä»¬çš„å«ä¹‰æ˜¯ï¼š</p>
<p>URG:Urget pointer is valid (ç´§æ€¥æŒ‡é’ˆå­—æ®µå€¼æœ‰æ•ˆ)</p>
<p>SYN: è¡¨ç¤ºå»ºç«‹è¿æ¥</p>
<p>FIN: è¡¨ç¤ºå…³é—­è¿æ¥</p>
<p>ACK: è¡¨ç¤ºå“åº”</p>
<p>PSH: è¡¨ç¤ºæœ‰ DATAæ•°æ®ä¼ è¾“</p>
<p>RST: è¡¨ç¤ºè¿æ¥é‡ç½®ã€‚</p>
<p>â€‹       å…¶ä¸­ï¼ŒACKæ˜¯å¯èƒ½ä¸SYNï¼ŒFINç­‰åŒæ—¶ä½¿ç”¨çš„ï¼Œæ¯”å¦‚SYNå’ŒACKå¯èƒ½åŒæ—¶ä¸º1ï¼Œå®ƒè¡¨ç¤ºçš„å°±æ˜¯å»ºç«‹è¿æ¥ä¹‹åçš„å“åº”ï¼Œå¦‚æœåªæ˜¯å•ä¸ªçš„ä¸€ä¸ªSYNï¼Œå®ƒè¡¨ ç¤ºçš„åªæ˜¯å»ºç«‹è¿æ¥ã€‚TCPçš„å‡ æ¬¡æ¡æ‰‹å°±æ˜¯é€šè¿‡è¿™æ ·çš„ACKè¡¨ç°å‡ºæ¥çš„ã€‚ä½†SYNä¸FINæ˜¯ä¸ä¼šåŒæ—¶ä¸º1çš„ï¼Œå› ä¸ºå‰è€…è¡¨ç¤ºçš„æ˜¯å»ºç«‹è¿æ¥ï¼Œè€Œåè€…è¡¨ç¤ºçš„æ˜¯æ–­å¼€ è¿æ¥ã€‚RSTä¸€èˆ¬æ˜¯åœ¨FINä¹‹åæ‰ä¼šå‡ºç°ä¸º1çš„æƒ…å†µï¼Œè¡¨ç¤ºçš„æ˜¯è¿æ¥é‡ç½®ã€‚ä¸€èˆ¬åœ°ï¼Œå½“å‡ºç°FINåŒ…æˆ–RSTåŒ…æ—¶ï¼Œæˆ‘ä»¬ä¾¿è®¤ä¸ºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯æ–­å¼€äº†è¿æ¥ï¼›è€Œ å½“å‡ºç°SYNå’ŒSYNï¼‹ACKåŒ…æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨å»ºç«‹äº†ä¸€ä¸ªè¿æ¥ã€‚PSHä¸º1çš„æƒ…å†µï¼Œä¸€èˆ¬åªå‡ºç°åœ¨ DATAå†…å®¹ä¸ä¸º0çš„åŒ…ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´PSHä¸º1è¡¨ç¤ºçš„æ˜¯æœ‰çœŸæ­£çš„TCPæ•°æ®åŒ…å†…å®¹è¢«ä¼ é€’ã€‚</p>
<p>â€‹      TCPäº§ç”Ÿ RSTå“åº”çš„æƒ…å†µï¼ˆå±äºç¡¬é”™è¯¯ï¼‰:</p>
<p>â€‹       å››æ¬¡æ¡æ‰‹ä¸æ˜¯å…³é—­ TCPè¿æ¥çš„å”¯ä¸€æ–¹æ³•. æœ‰æ—¶,å¦‚æœä¸»æœºéœ€è¦å°½å¿«å…³é—­è¿æ¥(æˆ–è¿æ¥è¶…æ—¶,ç«¯å£æˆ–ä¸»æœºä¸å¯è¾¾)ï¼ŒRST (Reset)åŒ…å°†è¢«å‘é€. æ³¨æ„åœ¨ï¼Œç”±äºRSTåŒ…ä¸æ˜¯TCPè¿æ¥ä¸­çš„å¿…é¡»éƒ¨åˆ†, å¯ä»¥åªå‘é€RSTåŒ…(å³ä¸å¸¦ACKæ ‡è®°). ä½†åœ¨æ­£å¸¸çš„TCPè¿æ¥ä¸­RSTåŒ…å¯ä»¥å¸¦ACKç¡®è®¤æ ‡è®°</p>
<ol>
<li><p>synå‘é€åˆ°æœåŠ¡å™¨ä¸»æœºï¼Œä½†æ˜¯ç›®çš„ç«¯å£å¹¶æœªè¿è¡Œã€‚åˆ™äº§ç”Ÿä¸€ä¸ªECONRFUSEDé”™è¯¯ã€‚å®¢æˆ·ç«¯ç«‹å³è¿”å›ã€‚æ¯”å¦‚telnet 192.168.1.55 8889ï¼Œæ¡ä»¶ï¼š55ä¸»æœºåœ¨å±€åŸŸç½‘ä¸Šå¹¶ä¸”å¯è¾¾ï¼ˆä¹Ÿå¯ä»¥æ¢æˆå¯ä»¥åˆ°è¾¾çš„ç½‘ç»œipåœ°å€ï¼‰ï¼Œä½†æ˜¯8889è¿™ä¸ªç«¯å£å¹¶æœªä½¿ç”¨ï¼ˆå¯èƒ½æœåŠ¡å™¨å·²ç»å…³é—­ï¼‰ï¼Œåˆ™æœåŠ¡å™¨ï¼ˆå¯¹ æ–¹ä¸»æœºtcpå†…æ ¸ï¼‰å‘é€ä¸€ä¸ªrstç›¸åº”ç»™å®¢æˆ·ç«¯ï¼Œäºæ˜¯å®¢æˆ·ç«¯ç«‹å³å…³é—­ã€‚ æ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœè¾“å…¥çš„ç½‘ç»œipä¸å¯è¾¾çš„è¯ï¼Œå®¢æˆ·ç«¯å°†ä¼šæŒç»­å‘é€synï¼Œæœ€åäº§ç”Ÿä¸€ä¸ªetimeoutçš„é”™è¯¯ï¼Œå¤§æ¦‚75ç§’å·¦å³ã€‚è¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯çš„é»˜è®¤ç½‘å…³ (192.168.1.1 211.2.2.2)å› ä¸ºæ‰¾ä¸åˆ°ä¸‹ä¸€è·¯ç”±ï¼Œè·¯ç”±å™¨ï¼ˆæˆ–è€…å†è¿‡å‡ è·³çš„è·¯ç”±å™¨ï¼‰ä¼šäº§ç”Ÿä¸€ä¸ªEHOSTUNREACHå“åº”ç»™å®¢æˆ·ç«¯ï¼ˆæ³¨ æ„ï¼ŒENETUNREACHå’ŒEHOSTUNREACHé€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºENETUNREACHä¸€èˆ¬å½“ä½œå·²è¿‡æ—¶ï¼‰ï¼Œç”±äºè¿™æ˜¯ä¸ªè½¯é”™è¯¯ï¼ˆæœ‰å¯èƒ½æ˜¯ ç½‘ç»œæš‚æ—¶ä¸é€šé€ æˆçš„ï¼‰ã€‚å®¢æˆ·ç«¯ä¼šé‡å‘synç›´åˆ°è¶…æ—¶ã€‚</p>
<pre><code>æ‰€ä»¥ä¼šæœ‰ telnet 192.168.1.55 8888  ä¸»æœºå­˜åœ¨ï¼Œä½†æ˜¯ç«¯å£æœªå¼€ï¼ŒECONRFUSEDé”™è¯¯ï¼Œç«‹åˆ»è¿”å›
         telnet 192.168.1.56 *     ä¸»æœºä¸å­˜åœ¨ï¼ŒUNROUTETOHOSTé”™è¯¯ï¼Œç«‹åˆ»è¿”å›
         telnet 211.1.1.5    *     ä¸»æœºä¸å­˜åœ¨ï¼Œetimeouté”™è¯¯
</code></pre></li>
<li><p>æœ€ç®€å•çš„æƒ…å†µï¼ŒæœåŠ¡å™¨ä¸»åŠ¨å‘é€rstç»™å®¢æˆ·ç«¯å…³é—­è¿æ¥ã€‚å®¢æˆ·ç«¯read writeç›´æ¥è¿”å›rsté”™è¯¯ã€‚</p>
</li>
<li><p>æœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„è¿æ¥è¿”å›rstå“åº”ã€‚æ¯”å¦‚ï¼ŒæœåŠ¡å™¨é‡å¯ä¹‹åï¼Œå…ˆå‰çš„ä¸€ä¸ªå·²è¿æ¥çš„å®¢æˆ·ç«¯æ¯«ä¸ä¹‹æƒ…çš„æƒ…å†µä¸‹,è¿™å°±æ˜¯åŠé—­è¿æ¥ï¼ˆè·ŸåŠå¼€è¿æ¥æœ€å¤§çš„ä¸åŒæ˜¯ï¼ŒåŠé—­è¿æ¥æ˜¯ä¸èƒ½ä½¿ç”¨çš„ï¼ŒåŠå¼€è¿æ¥å¯ä»¥ä½¿ç”¨ï¼‰ã€‚</p>
<pre><code>æ­¤æ—¶,å¦‚æœå®¢æˆ·ç«¯readçš„è¯ï¼ˆæ¥æ”¶ç¼“å†²æ— æ•°æ®ï¼‰äº§ç”Ÿä¸€ä¸ªEPEERRSTé”™è¯¯
        å¦‚æœå®¢æˆ·ç«¯writeçš„è¯ä¸”å‘é€æ•°æ®å°äºå‘é€ç¼“å†²åŒºå‰©ä½™å®¹é‡æ—¶ï¼Œç¬¬ä¸€æ¬¡writeæˆåŠŸï¼Œç¬¬äºŒæ¬¡writeæˆ–è€…readçš„æ—¶å€™å°±ä¼šäº§ç”Ÿä¸€ä¸ª EPEERRSTçš„é”™è¯¯ã€‚å› ä¸ºwriteå‘é€æ•°æ®æ˜¯ç›´æ¥æŠŠè¦å‘é€çš„æ•°æ®æ‹·è´åˆ°å†…æ ¸çš„tcpå‘é€ç¼“å†²åŒºå°±ç«‹åˆ»è¿”å›æˆåŠŸçš„ã€‚å½“ç„¶æ‹·è´ä¹‹å‰ä¼šå…ˆæ£€æŸ¥ä¸€ä¸‹tcpè¿ æ¥æœ‰æ— é”™è¯¯ã€‚æ‰€ä»¥ç¬¬äºŒæ¬¡å‘é€æˆ–è€…æ¥æ”¶çš„æ—¶å€™ï¼Œå‘ç°è¿æ¥ä¸Šå·²ç»æœ‰äº†EPEERRSTçš„é”™è¯¯ï¼Œæ‰€ä»¥å°±è¿”å›é”™è¯¯ï¼ˆè¯è¯´å›æ¥ï¼Œç¬¬ä¸€æ¬¡å‘é€çš„æ•°æ®å®é™…ä¸Šæ ¹æœ¬å°±æ²¡æœ‰å‘ é€æˆåŠŸï¼Œå¯¹æ–¹æ ¹æœ¬å°±æ²¡æ¥å—å®ƒï¼‰
</code></pre></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2019/02/23/MSLã€TTLå’ŒRTTç®€ä»‹/" data-id="cjwkgb27p0005lpzbs0n05df7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MSL/">MSL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RTT/">RTT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TTL/">TTL</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-reactæºç ä¿®æ”¹è®°å½•" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/23/reactæºç ä¿®æ”¹è®°å½•/" class="article-date">
  <time datetime="2019-02-22T16:00:00.000Z" itemprop="datePublished">2019-02-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>â–º<a class="article-category-link" href="/categories/iOS/ReactNative/">ReactNative</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/23/reactæºç ä¿®æ”¹è®°å½•/">reactæºç ä¿®æ”¹è®°å½•</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li><p>RCTImageLoader.mæ–‡ä»¶</p>
<p>å‡½æ•°- (BOOL)canHandleRequest:(NSURLRequest *)request</p>
<p>åŸä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)canHandleRequest:(NSURLRequest *)request</span><br><span class="line">&#123;</span><br><span class="line">    NSURL *requestURL = request.URL;</span><br><span class="line"></span><br><span class="line">    // If the data being loaded is a video, return NO</span><br><span class="line">    // Even better may be to implement this on the RCTImageURLLoader that would try to load it,</span><br><span class="line">    // but we&apos;d have to run the logic both in RCTPhotoLibraryImageLoader and</span><br><span class="line">    // RCTAssetsLibraryRequestHandler. Once we drop iOS7 though, we&apos;d drop</span><br><span class="line">    // RCTAssetsLibraryRequestHandler and can move it there.</span><br><span class="line">    static NSRegularExpression *videoRegex = nil;</span><br><span class="line">    if (!videoRegex) &#123;</span><br><span class="line">      NSError *error = nil;</span><br><span class="line">      videoRegex = [NSRegularExpression regularExpressionWithPattern:@&quot;(?:&amp;|^)ext=MOV(?:&amp;|$)&quot;</span><br><span class="line">                                                             options:NSRegularExpressionCaseInsensitive</span><br><span class="line">                                                               error:&amp;error];</span><br><span class="line">      if (error) &#123;</span><br><span class="line">        RCTLogError(@&quot;%@&quot;, error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    NSString *query = requestURL.query;</span><br><span class="line">	...</span><br><span class="line">    return NO;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é—®é¢˜:åœ¨å¼‚æ­¥å¤šçº¿ç¨‹ä¸‹<code>static NSRegularExpression *videoRegex;</code>ä¸­çš„videoRegexä¼šå­˜åœ¨2+æ¬¡ç”Ÿæˆ,å‡½æ•°firstMatchInString:options:rangeæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°videoRegexè¢«é‡ç½®nilçš„å¼‚å¸¸æƒ…å†µ,å¯¼è‡´å‘ç”Ÿcrash.æ‰€ä»¥éœ€è¦å¯¹videoRegexç”Ÿæˆçš„æ–¹æ³•ä¸¥æ ¼åªæ‰§è¡Œä¸€æ¬¡!  åˆ©ç”¨<strong>dispatch_once_t</strong></p>
<p>ä¿®æ”¹åçš„ä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)canHandleRequest:(NSURLRequest *)request</span><br><span class="line">&#123;</span><br><span class="line">    NSURL *requestURL = request.URL;</span><br><span class="line"></span><br><span class="line">    // If the data being loaded is a video, return NO</span><br><span class="line">    // Even better may be to implement this on the RCTImageURLLoader that would try to load it,</span><br><span class="line">    // but we&apos;d have to run the logic both in RCTPhotoLibraryImageLoader and</span><br><span class="line">    // RCTAssetsLibraryRequestHandler. Once we drop iOS7 though, we&apos;d drop</span><br><span class="line">    // RCTAssetsLibraryRequestHandler and can move it there.</span><br><span class="line">    static NSRegularExpression *videoRegex = nil;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        NSError *error = nil;</span><br><span class="line">        videoRegex = [NSRegularExpression  regularExpressionWithPattern:@&quot;(?:&amp;|^)ext=MOV(?:&amp;|$)&quot;</span><br><span class="line">                                                                options:NSRegularExpressionCaseInsensitive</span><br><span class="line">                                                                  error:&amp;error];</span><br><span class="line">        if (error) &#123;</span><br><span class="line">            RCTLogError(@&quot;%@&quot;, error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    NSString *query = requestURL.query;</span><br><span class="line">	...</span><br><span class="line">    return NO;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="2">
<li><p>RCTSRWebSocket.m</p>
<p>åœ¨debugè”è°ƒæ¨¡å¼ä¸‹å‡ºç°äº†å¦‚ä¸‹å›¾æ‰€ç¤ºçš„crash</p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/reactæºç ä¿®æ”¹è®°å½•01.png" alt="image1"></p>
<p>ä¿®æ”¹å:</p>
<p>æ•´ä¸ªæ–‡ä»¶å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line">@implementation RCTSRWebSocket</span><br><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  BOOL _cleanupScheduled;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">- (void)_failWithError:(NSError *)error;</span><br><span class="line">&#123;</span><br><span class="line">  dispatch_async(_workQueue, ^&#123;</span><br><span class="line">    if (self.readyState != RCTSR_CLOSED) &#123;</span><br><span class="line">      self-&gt;_failed = YES;</span><br><span class="line">      [self _performDelegateBlock:^&#123;</span><br><span class="line">        if ([self.delegate respondsToSelector:@selector(webSocket:didFailWithError:)]) &#123;</span><br><span class="line">          [self.delegate webSocket:self didFailWithError:error];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;];</span><br><span class="line"></span><br><span class="line">      self.readyState = RCTSR_CLOSED;</span><br><span class="line">      </span><br><span class="line">      RCTSRLog(@&quot;Failing with error %@&quot;, error.localizedDescription);</span><br><span class="line"></span><br><span class="line">      [self _disconnect];</span><br><span class="line">      [self _scheduleCleanup];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">- (void)stream:(NSStream *)aStream handleEvent:(NSStreamEvent)eventCode;</span><br><span class="line">&#123;</span><br><span class="line">  if (_secure &amp;&amp; !_pinnedCertFound &amp;&amp; (eventCode == NSStreamEventHasBytesAvailable || eventCode == NSStreamEventHasSpaceAvailable)) &#123;</span><br><span class="line">    NSArray *sslCerts = _urlRequest.RCTSR_SSLPinnedCertificates;</span><br><span class="line">    if (sslCerts) &#123;</span><br><span class="line">      SecTrustRef secTrust = (__bridge SecTrustRef)[aStream propertyForKey:(__bridge id)kCFStreamPropertySSLPeerTrust];</span><br><span class="line">      if (secTrust) &#123;</span><br><span class="line">        NSInteger numCerts = SecTrustGetCertificateCount(secTrust);</span><br><span class="line">        for (NSInteger i = 0; i &lt; numCerts &amp;&amp; !_pinnedCertFound; i++) &#123;</span><br><span class="line">          SecCertificateRef cert = SecTrustGetCertificateAtIndex(secTrust, i);</span><br><span class="line">          NSData *certData = CFBridgingRelease(SecCertificateCopyData(cert));</span><br><span class="line"></span><br><span class="line">          for (id ref in sslCerts) &#123;</span><br><span class="line">            SecCertificateRef trustedCert = (__bridge SecCertificateRef)ref;</span><br><span class="line">            NSData *trustedCertData = CFBridgingRelease(SecCertificateCopyData(trustedCert));</span><br><span class="line"></span><br><span class="line">            if ([trustedCertData isEqualToData:certData]) &#123;</span><br><span class="line">              _pinnedCertFound = YES;</span><br><span class="line">              break;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (!_pinnedCertFound) &#123;</span><br><span class="line">        dispatch_async(_workQueue, ^&#123;</span><br><span class="line">          [self _failWithError:[NSError errorWithDomain:RCTSRWebSocketErrorDomain code:23556 userInfo:@&#123;NSLocalizedDescriptionKey: [NSString stringWithFormat:@&quot;Invalid server cert&quot;]&#125;]];</span><br><span class="line">        &#125;);</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // _workQueue cannot be NULL</span><br><span class="line">  if (!_workQueue) &#123; return; &#125;</span><br><span class="line">  __weak typeof(self) weakSelf = self;</span><br><span class="line">  dispatch_async(_workQueue, ^&#123;</span><br><span class="line">    typeof(self) strongSelf = weakSelf;</span><br><span class="line">    if (!strongSelf) &#123; return; &#125;</span><br><span class="line">    [strongSelf safeHandleEvent:eventCode stream:aStream];</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)safeHandleEvent:(NSStreamEvent)eventCode stream:(NSStream *)aStream</span><br><span class="line">&#123;</span><br><span class="line">  switch (eventCode) &#123;</span><br><span class="line">    case NSStreamEventOpenCompleted: &#123;</span><br><span class="line">      RCTSRLog(@&quot;NSStreamEventOpenCompleted %@&quot;, aStream);</span><br><span class="line">      if (self.readyState &gt;= RCTSR_CLOSING) &#123;</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">      assert(self-&gt;_readBuffer);</span><br><span class="line">      </span><br><span class="line">      if (self.readyState == RCTSR_CONNECTING &amp;&amp; aStream == self-&gt;_inputStream) &#123;</span><br><span class="line">        [self didConnect];</span><br><span class="line">      &#125;</span><br><span class="line">      [self _pumpWriting];</span><br><span class="line">      [self _pumpScanner];</span><br><span class="line">      break;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    case NSStreamEventErrorOccurred: &#123;</span><br><span class="line">      RCTSRLog(@&quot;NSStreamEventErrorOccurred %@ %@&quot;, aStream, [aStream.streamError copy]);</span><br><span class="line">      // TODO: specify error better!</span><br><span class="line">      [self _failWithError:aStream.streamError];</span><br><span class="line">      self-&gt;_readBufferOffset = 0;</span><br><span class="line">      self-&gt;_readBuffer.length = 0;</span><br><span class="line">      break;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    case NSStreamEventEndEncountered: &#123;</span><br><span class="line">      [self _pumpScanner];</span><br><span class="line">      RCTSRLog(@&quot;NSStreamEventEndEncountered %@&quot;, aStream);</span><br><span class="line">      if (aStream.streamError) &#123;</span><br><span class="line">        [self _failWithError:aStream.streamError];</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        dispatch_async(self-&gt;_workQueue, ^&#123;</span><br><span class="line">          if (self.readyState != RCTSR_CLOSED) &#123;</span><br><span class="line">            self.readyState = RCTSR_CLOSED;</span><br><span class="line">            [self _scheduleCleanup];</span><br><span class="line">          &#125;</span><br><span class="line">          </span><br><span class="line">          if (!self-&gt;_sentClose &amp;&amp; !self-&gt;_failed) &#123;</span><br><span class="line">            self-&gt;_sentClose = YES;</span><br><span class="line">            // If we get closed in this state it&apos;s probably not clean because we should be sending this when we send messages</span><br><span class="line">            [self _performDelegateBlock:^&#123;</span><br><span class="line">              if ([self.delegate respondsToSelector:@selector(webSocket:didCloseWithCode:reason:wasClean:)]) &#123;</span><br><span class="line">                [self.delegate webSocket:self didCloseWithCode:RCTSRStatusCodeGoingAway reason:@&quot;Stream end encountered&quot; wasClean:NO];</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      break;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    case NSStreamEventHasBytesAvailable: &#123;</span><br><span class="line">      RCTSRLog(@&quot;NSStreamEventHasBytesAvailable %@&quot;, aStream);</span><br><span class="line">      const int bufferSize = 2048;</span><br><span class="line">      uint8_t buffer[bufferSize];</span><br><span class="line">      </span><br><span class="line">      while (self-&gt;_inputStream.hasBytesAvailable) &#123;</span><br><span class="line">        NSInteger bytes_read = [self-&gt;_inputStream read:buffer maxLength:bufferSize];</span><br><span class="line">        </span><br><span class="line">        if (bytes_read &gt; 0) &#123;</span><br><span class="line">          [self-&gt;_readBuffer appendBytes:buffer length:bytes_read];</span><br><span class="line">        &#125; else if (bytes_read &lt; 0) &#123;</span><br><span class="line">          [self _failWithError:self-&gt;_inputStream.streamError];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        if (bytes_read != bufferSize) &#123;</span><br><span class="line">          break;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      [self _pumpScanner];</span><br><span class="line">      break;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    case NSStreamEventHasSpaceAvailable: &#123;</span><br><span class="line">      RCTSRLog(@&quot;NSStreamEventHasSpaceAvailable %@&quot;, aStream);</span><br><span class="line">      [self _pumpWriting];</span><br><span class="line">      break;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    default:</span><br><span class="line">      RCTSRLog(@&quot;(default) %@&quot;, aStream);</span><br><span class="line">      break;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)_scheduleCleanup</span><br><span class="line">&#123;</span><br><span class="line">  if (_cleanupScheduled) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  _cleanupScheduled = YES;</span><br><span class="line">  </span><br><span class="line">  // Cleanup NSStream&apos;s delegate in the same RunLoop used by the streams themselves:</span><br><span class="line">  // This way we&apos;ll prevent race conditions between handleEvent and SRWebsocket&apos;s dealloc</span><br><span class="line">  NSTimer *timer = [NSTimer timerWithTimeInterval:(0.0f) target:self selector:@selector(_cleanupSelfReference:) userInfo:nil repeats:NO];</span><br><span class="line">  [[NSRunLoop RCTSR_networkRunLoop] addTimer:timer forMode:NSDefaultRunLoopMode];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)_cleanupSelfReference:(NSTimer *)timer</span><br><span class="line">&#123;</span><br><span class="line">  // Remove the streams, right now, from the networkRunLoop</span><br><span class="line">  [_inputStream close];</span><br><span class="line">  [_outputStream close];</span><br><span class="line">  </span><br><span class="line">  // Unschedule from RunLoop</span><br><span class="line">  for (NSArray *runLoop in [_scheduledRunloops copy]) &#123;</span><br><span class="line">    [self unscheduleFromRunLoop:runLoop[0] forMode:runLoop[1]];</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // Nuke NSStream&apos;s delegate</span><br><span class="line">  _inputStream.delegate = nil;</span><br><span class="line">  _outputStream.delegate = nil;</span><br><span class="line">  </span><br><span class="line">  // Cleanup selfRetain in the same GCD queue as usual</span><br><span class="line">  dispatch_async(_workQueue, ^&#123;</span><br><span class="line">    self-&gt;_selfRetain = nil;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2019/02/23/reactæºç ä¿®æ”¹è®°å½•/" data-id="cjwkgb28s001olpzblmb31fk9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RN-Bug/">RN-Bug</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-xcodeæŠ¥é”™" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/21/xcodeæŠ¥é”™/" class="article-date">
  <time datetime="2019-02-20T16:00:00.000Z" itemprop="datePublished">2019-02-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/21/xcodeæŠ¥é”™/">Xcode å·¥ç¨‹ç¼–è¯‘æŠ¥é”™</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>dyld_shared_cache_extract_dylibs failed</strong></p>
<p>è®¾å¤‡é‡æ–°è®¾ç½®ä¿¡ä»»,åœ¨<code>Xcode</code>- <code>Window</code>- <code>Devices and Simulators</code> ä¸­æ‰“å¼€</p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/2019050700001.jpg" alt="image"></p>
<p>ç„¶åé€‰ä¸­ å¯¹åº”çš„è®¾å¤‡ å³é”® <code>Unpair Device</code>  å¯¹è®¾å¤‡é‡æ–°ä¿¡ä»».</p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/2019050700002.jpg" alt="image"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2019/02/21/xcodeæŠ¥é”™/" data-id="cjwkgb27z000ilpzbleputkg1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/XCodeæŠ¥é”™/">XCodeæŠ¥é”™</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-NSProxy" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/23/NSProxy/" class="article-date">
  <time datetime="2019-01-22T16:00:00.000Z" itemprop="datePublished">2019-01-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/23/NSProxy/">NSProxyç®€ä»‹</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="NSProxyæ˜¯ä»€ä¹ˆ"><a href="#NSProxyæ˜¯ä»€ä¹ˆ" class="headerlink" title="NSProxyæ˜¯ä»€ä¹ˆ?"></a>NSProxyæ˜¯ä»€ä¹ˆ?</h2><p><code>NSProxy</code> æ˜¯NSProxy æ˜¯ä¸€ä¸ª<strong>æŠ½è±¡ç±»</strong>,è·Ÿ <code>NSObject</code> ä¸€æ ·çš„åŸºç±»ï¼Œéƒ½éµå®ˆ<code>&lt;NSObject&gt;</code>åè®®</p>
<p><code>NSProxy</code>æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¿…é¡»ç»§æ‰¿å®ä¾‹åŒ–å…¶å­ç±»æ‰èƒ½ä½¿ç”¨ã€‚</p>
<p><code>NSProxy</code>ä»ç±»åæ¥çœ‹æ˜¯ä»£ç†ç±»ä¸“é—¨è´Ÿè´£ä»£ç†å¯¹è±¡è½¬å‘æ¶ˆæ¯çš„ã€‚ç›¸æ¯”<code>NSObject</code>ç±»æ¥è¯´<code>NSProxy</code>æ›´è½»é‡çº§ï¼Œé€šè¿‡<code>NSProxy</code>å¯ä»¥å¸®åŠ©<code>Objective-C</code>é—´æ¥çš„å®ç°å¤šé‡ç»§æ‰¿çš„åŠŸèƒ½ã€‚</p>
<h2 id="æ¶ˆæ¯è½¬å‘æœºåˆ¶"><a href="#æ¶ˆæ¯è½¬å‘æœºåˆ¶" class="headerlink" title="æ¶ˆæ¯è½¬å‘æœºåˆ¶"></a>æ¶ˆæ¯è½¬å‘æœºåˆ¶</h2><p>å½“ç¨‹åºè¿è¡Œæ—¶è°ƒç”¨ä¸€ä¸ªæ²¡æœ‰å®ç°çš„æ–¹æ³•ï¼Œä¼šé‡‡ç”¨ä¸‰ä¸ªæ¶ˆæ¯è½¬å‘æ­¥éª¤å¦‚æœè¿™ä¸‰ä¸ªæ­¥éª¤éƒ½ä¸èƒ½æˆåŠŸé‚£ä¹ˆæ­¤æ—¶ç¨‹åºä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</p>
<p>1.æ·»åŠ æ–¹æ³•åˆ°ç±»å¯¹è±¡ï¼Œå¯¹äºå®ä¾‹æ–¹æ³•è°ƒç”¨respondsToSelector:ï¼Œå¯¹äºç±»æ–¹æ³•è°ƒç”¨resolveClassMethod:ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ (BOOL)resolveClassMethod:(SEL)sel;</span><br><span class="line">- (BOOL)respondsToSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<p>2.æŸ¥æ‰¾forwardingTargetForSelector:æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¦‚æœè¿”å›nilé‚£ä¹ˆå°†è·³è½¬åˆ°ä¸‹ä¸€æ­¥éª¤ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (id)forwardingTargetForSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<p>3.é€šè¿‡methodSignatureForSelector:æ–¹æ³•è·å–ä¸€ä¸ªNSMethodSignatureç±»å‹çš„å¯¹è±¡ï¼Œè°ƒç”¨forwardInvocation:æ–¹æ³•ã€‚æ”¹æ–¹æ³•ä¼ å…¥ä¸€ä¸ªå°è£…äº†NSMethodSignatureçš„NSInvocationå¯¹è±¡ã€‚ç„¶åè¯¥å¯¹è±¡é€šè¿‡invakeWithTarget:æ–¹æ³•å°†æ¶ˆæ¯è½¬å‘ç»™å…¶å®ƒå¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector;</span><br><span class="line"></span><br><span class="line">- (void)forwardInvocation:(NSInvocation *)invocation;</span><br></pre></td></tr></table></figure>
<h2 id="NSProxy-å’Œ-NSObject-çš„æ¯”è¾ƒ"><a href="#NSProxy-å’Œ-NSObject-çš„æ¯”è¾ƒ" class="headerlink" title="NSProxy å’Œ NSObject çš„æ¯”è¾ƒ"></a>NSProxy å’Œ NSObject çš„æ¯”è¾ƒ</h2><p>ç›¸æ¯”NSObject,NSProxyæ›´è½»é‡çº§,  åšæ¶ˆæ¯è½¬å‘æ•ˆç‡æ›´é«˜.</p>
<p>NSObjectå¯»æ‰¾æ–¹æ³•é¡ºåºï¼šæœ¬ç±»-&gt;(çˆ¶ç±»-)&gt;(åŠ¨æ€æ–¹æ³•è§£æ)-&gt; æ¶ˆæ¯è½¬å‘ï¼›<br>NSproxyé¡ºåºï¼šæœ¬ç±»-&gt;æ¶ˆæ¯è½¬å‘</p>
<h2 id="NSProxyçš„ç”¨é€”"><a href="#NSProxyçš„ç”¨é€”" class="headerlink" title="NSProxyçš„ç”¨é€”"></a>NSProxyçš„ç”¨é€”</h2><ol>
<li><p>AOPé¢å‘åˆ‡ç‰‡ç¼–ç¨‹</p>
<p>iOSä¸­é¢å‘åˆ‡ç‰‡ç¼–ç¨‹ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ ï¼Œä¸€ä¸ªæ˜¯ç›´æ¥åŸºäºruntime çš„method-Swizzling.è¿˜æœ‰ä¸€ç§å°±æ˜¯åŸºäºNSProxy</p>
</li>
<li><p>è§£å†³NSTimer, CADisplayLinkç­‰å¼ºå¼•ç”¨targetå¼•èµ·çš„æ— æ³•é‡Šæ”¾é—®é¢˜ã€‚å¦‚NSTimer:åˆ©ç”¨æ¶ˆæ¯è½¬å‘æ¥æ–­å¼€NSTimerå¯¹è±¡ä¸è§†å›¾ä¹‹é—´çš„å¼ºå¼•ç”¨å…³ç³»ã€‚åˆå§‹åŒ–NSTimeræ—¶æŠŠè§¦å‘äº‹ä»¶çš„targetæ›¿æ¢æˆä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œç„¶åè¿™ä¸ªå¯¹è±¡ä¸­NSTimerçš„SELæ–¹æ³•è§¦å‘æ—¶è®©è¿™ä¸ªæ–¹æ³•åœ¨å½“å‰çš„è§†å›¾selfä¸­å®ç°ã€‚</p>
</li>
<li><p>å¤šé‡ç»§æ‰¿</p>
<p>å®ç°ç±»ä¼¼CAAnimationç±»æ—.</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2019/01/23/NSProxy/" data-id="cjwkgb27d0000lpzb53rkwlg4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NSProxy/">NSProxy</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-React Native" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/23/React Native/" class="article-date">
  <time datetime="2018-07-22T16:00:00.000Z" itemprop="datePublished">2018-07-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/23/React Native/">React Native æ–¹æ¡ˆé¢„ç ”</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-RNè·³è½¬Nativeçš„è·¯ç”±"><a href="#1-RNè·³è½¬Nativeçš„è·¯ç”±" class="headerlink" title="1. RNè·³è½¬Nativeçš„è·¯ç”±"></a>1. RNè·³è½¬Nativeçš„è·¯ç”±</h2><p>è·¯ç”±åœ¨é¡¹ç›®ä¸­ä¸»è¦ä½œç”¨æœ‰:</p>
<ol>
<li>é™ä½Appé¡µé¢ä¹‹é—´çš„è€¦åˆæ€§ã€‚éšç€é¡¹ç›®è¶Šæ¥è¶Šå¤æ‚ï¼Œå„ä¸ªç»„ä»¶å’Œé¡µé¢ä¹‹é—´çš„è·³è½¬ä¹Ÿå˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œä»–ä»¬ä¹‹é—´çš„è·³è½¬é€»è¾‘ä¹Ÿå˜çš„è¶Šæ¥è¶Šç´§å¯†ï¼Œè¿™å°±é€ æˆäº†å„ä¸ªæ¨¡å—çš„ç›¸äº’ä¾èµ–è¶Šæ¥è¶Šç´§å¯†</li>
<li>å¤§å‰ç«¯é¡µé¢è·³è½¬çš„ä¸€è‡´æ€§.</li>
<li>å¯ä»¥é€šè¿‡åŠ¨æ€ä¸‹å‘é…ç½®è¡¨æ¥é…ç½®Appçš„è·³è½¬é€»è¾‘ã€‚è¿™æ ·iOSå’ŒAndroidä¸¤è¾¹åªè¦å…±ç”¨ä¸€å¥—é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ä¸‹å‘ä¿®æ”¹åé…ç½®è¡¨ä¹Ÿèƒ½å®ç°åŠ¨æ€çš„æ”¹å˜æ˜ å°„ç›®æ ‡ã€‚</li>
</ol>
<h3 id="è·¯ç”±çš„å®šä¹‰"><a href="#è·¯ç”±çš„å®šä¹‰" class="headerlink" title="è·¯ç”±çš„å®šä¹‰"></a>è·¯ç”±çš„å®šä¹‰</h3><p>è·¯ç”±çš„å®šä¹‰æœ‰å¾ˆå¤šç§,ä¸ºäº†å…¼å®¹é¡¹ç›®ä¹‹å‰çš„è·¯ç”±å®šä¹‰,rnè·¯ç”±å®šä¹‰å¦‚ä¸‹:</p>
<p>jsonStirng = {â€œmethodNameâ€:â€methodNameâ€,â€dataâ€:{} }</p>
<p>æ–¹æ³•å:<code>methodName</code>  è·¯ç”±çš„æ–¹æ³•å,å¦‚Notification_callNativeEvent, é€šçŸ¥æ¨¡å—, è°ƒç”¨åŸç”Ÿé€šçŸ¥</p>
<p>å‚æ•°:<code>data</code> æ˜¯ä¸€ä¸ªmapç»“æ„,ç”¨äºreactå‘nativeä¼ çš„å‚æ•°.</p>
<p>å¿½ç•¥:methodNameæ ¼å¼: â€œmoduleName_actionâ€</p>
<h3 id="å’Œjsä¸nativeè·¯ç”±çš„æ¯”è¾ƒ"><a href="#å’Œjsä¸nativeè·¯ç”±çš„æ¯”è¾ƒ" class="headerlink" title="å’Œjsä¸nativeè·¯ç”±çš„æ¯”è¾ƒ:"></a>å’Œjsä¸nativeè·¯ç”±çš„æ¯”è¾ƒ:</h3><ul>
<li>jsä¸nativeä¸­æœ‰<code>callbackId</code>,ä½†æ˜¯è¿™é‡Œæ²¡æœ‰äº†, å› ä¸ºreactè°ƒç”¨nativeæœ‰ä¸ªpromiseçš„è¿”å›ä½“,è¯·æ±‚å’Œè¿”å›æ˜¯ä¸€ä¸€å¯¹åº”çš„.</li>
</ul>
<p>reactå‘å‡ºencodeåçš„jsonStirng, nativeè·å–jsonStirngådecode,æ ¹æ®è§„åˆ™è§£æå‡ºå¯¹åº”çš„éƒ¨åˆ†.</p>
<p>æ•°æ®ä¼ è¾“çš„æµç¨‹å›¾å¦‚ä¸‹:</p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/006tKfTcly1g19d0bqpy4j30mu0ruabk.jpg" alt="image-20190320165306011"></p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/006tKfTcly1g19d0tdcuzj30h80iemyf.jpg" alt="image-20190320165334729"></p>
<h2 id="2-Nativeè¿›å…¥RNæˆ–è€…H5"><a href="#2-Nativeè¿›å…¥RNæˆ–è€…H5" class="headerlink" title="2. Nativeè¿›å…¥RNæˆ–è€…H5"></a>2. Nativeè¿›å…¥RNæˆ–è€…H5</h2><p>æ¯”å¦‚åœ¨é¦–é¡µç‚¹å‡»Bannerè·³è½¬ï¼Œå¯ä»¥è·³è½¬H5ä¹Ÿå¯ä»¥è·³è½¬åˆ°RNï¼Œå¯ä»¥é€šè¿‡è§£æåå°ä¸‹å‘çš„Urlæ¥å†³å®šè·³è½¬çš„ç›®æ ‡ã€‚<br>ç¡®å®šè·³è½¬RNçš„åè®®å®šä½ä¸º <code>react://module/acion?params</code>,å…¶ä¸­<br><code>react://</code>ç¡®å®šè·³è½¬çš„æ˜¯RNé¡µé¢ï¼Œ<code>module/action</code>è¡¨ç¤ºè·³è½¬çš„æ¨¡å—å’Œå¯¹åº”çš„actionï¼Œ<code>params</code>æ˜¯ä¼ å…¥çš„å‚æ•°ã€‚<br>æµç¨‹å›¾å‚è€ƒ <code>RNçš„é™çº§</code></p>
<h2 id="3-RNçš„é™çº§"><a href="#3-RNçš„é™çº§" class="headerlink" title="3. RNçš„é™çº§"></a>3. RNçš„é™çº§</h2><p>åœ¨react-nativeé¡µé¢ä¸­æ•è·å¼‚å¸¸,æ•è·åˆ°å¼‚å¸¸æˆ‘ä»¬ä¼šè®°å½•å¼‚å¸¸ç°åº¦ï¼Œå¹¶å¯¹ä¸šåŠ¡è¿›è¡Œé™çº§è·³è½¬åˆ°H5é¡µé¢.  RNé¡µé¢å’ŒH5é¡µé¢è·³è½¬æœºåˆ¶ä»¥åŠåå°å¯é…ç½®æ–¹æ¡ˆ:</p>
<p>é’ˆå¯¹åç«¯æ§åˆ¶çš„è·³è½¬rné¡µé¢,æœåŠ¡å™¨ä¸‹å‘è·¯ç”±åœ°å€{firstUrl:  secondUrl: }  ä¼˜å…ˆå­—æ®µå’Œå¤‡é€‰å­—æ®µ (é€‰æ‹©è·³è½¬rné¡µé¢è¿˜æ˜¯h5é¡µé¢)ã€‚ <code>æµç¨‹å›¾</code> </p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/006tKfTcly1g19d0lm30nj30ej0mwdh8.jpg" alt="image-20190320165322408"></p>
<p>ä¸Šå›¾ä¸­çš„åŠ è½½å¤±è´¥çš„åŸå› æœ‰å¤šç§: </p>
<ul>
<li><p>moduleæ³¨å†Œä¸ºç©º,é€‰ç”¨h5</p>
</li>
<li><p>ä¸šåŠ¡åœºæ™¯ä¸¥é‡é—®é¢˜,é€‰ç”¨h5</p>
</li>
</ul>
<p>åœ¨å®é™…ä¸šåŠ¡ä¸­,é™çº§æ–¹æ¡ˆå¯ä»¥æ”¾åˆ°åé¢,å› ä¸ºæœ‰çƒ­æ›´æ–°æœºåˆ¶, å¤§éƒ¨åˆ†é—®é¢˜å¯ä»¥åŠæ—¶ä¿®å¤ä¸”æ›´æ–°â€¦.</p>
<h2 id="4-çƒ­æ›´æ–°åŠŸèƒ½"><a href="#4-çƒ­æ›´æ–°åŠŸèƒ½" class="headerlink" title="4. çƒ­æ›´æ–°åŠŸèƒ½"></a>4. çƒ­æ›´æ–°åŠŸèƒ½</h2><p>çƒ­æ›´æ–°æ˜¯RNçš„éå¸¸é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½ç‰¹æ€§,<code>Code-Push</code>,æˆ‘ä»¬åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å·²ç»é›†æˆå¹¶å¼€å§‹ä½¿ç”¨äº†.è¿™è¾¹å°±ä¸é˜è¿°äº†.</p>
<p>æ¥ä¸‹æ¥:æˆ‘ä»¬ä¼šå¼€å‘ç»´æŠ¤èµ·è‡ªå·±çš„codepushæœåŠ¡åœ°å€,æ›´å¥½çš„æ§åˆ¶rnç‰ˆæœ¬.å¦‚æµ‹è¯•ç¯å¢ƒCode-Pushç™»å½•: <a href="http://10.0.0.115:3001/" target="_blank" rel="noopener">http://10.0.0.115:3001/</a> </p>
<h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„:"></a>æ³¨æ„:</h4><ul>
<li>è‹¹æœä¸å…è®¸åº”ç”¨å†…æœ‰å¼¹æ¡†æç¤ºæ›´æ–°</li>
</ul>
<h2 id="5-RNçš„ä¸šåŠ¡åŸºç¡€ç»„ä»¶å»ºç«‹"><a href="#5-RNçš„ä¸šåŠ¡åŸºç¡€ç»„ä»¶å»ºç«‹" class="headerlink" title="5. RNçš„ä¸šåŠ¡åŸºç¡€ç»„ä»¶å»ºç«‹"></a>5. RNçš„ä¸šåŠ¡åŸºç¡€ç»„ä»¶å»ºç«‹</h2><p>å› ä¸ºå®‰å“å’ŒiOSä¸¤ä¸ªå¹³å°çš„å·®å¼‚æ€§, æœ‰äº›UIç»„ä»¶çš„ç‰¹æ€§ä¸ä¸€è‡´,éœ€è¦åŒºåˆ†å¼€æ¥åˆ¤æ–­,RNè‡ªå·±æä¾›çš„ç»„ä»¶åº“è¿˜æ— æ³•æ»¡è¶³æˆ‘ä»¬çš„å®é™…çš„ä¸šåŠ¡éœ€æ±‚,æ‰€æœ‰æˆ‘ä»¬éœ€è¦è‡ªå·±æ¥è¿›è¡Œå°è£…,ä»¥æ–¹ä¾¿ä¸šåŠ¡å¼€å‘.</p>
<p>è®¡åˆ’:éšç€ä¸šåŠ¡å¼€å‘è¿­ä»£,é€æ¸å½¢æˆxhxè‡ªå·±çš„ä¸€å¥—RNç»„ä»¶åº“.</p>
<h2 id="6-RNåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯"><a href="#6-RNåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯" class="headerlink" title="6. RNåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯"></a>6. RNåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯</h2><p>ç”±äºRNåœ¨ä½¿ç”¨çš„æ—¶å€™,ä¼šå æ®ä¸€å®šçš„å†…å­˜ç©ºé—´, ä¸æ¨èä½¿ç”¨åœ¨å…¨å±€é™æ€çš„åœ°æ–¹,å› ä¸ºå®‰å“æœºappä½¿ç”¨å†…å­˜å—é™,å¦‚æœRNçš„åŠŸèƒ½æ¨¡å—å¸¸é©»åå°,ä¼šå½±å“å…¶ä»–åŠŸèƒ½çš„ä½¿ç”¨.</p>
<p>RNåœ¨åŸç”Ÿappä¸­å…¥å£:</p>
<ul>
<li>å›ºå®šå…¥å£çš„è·³è½¬</li>
<li>æœåŠ¡å™¨ä¸‹å‘çš„urlè¯†åˆ«è·³è½¬, å¦‚ç‚¹å‡»é¦–é¡µbanner,è¯†åˆ«urlå±äºrnçš„è·¯ç”±åœ°å€.</li>
</ul>
<p>åŠŸèƒ½ã€é¡µé¢ èµ°è·¯ç”±,ç»„ä»¶èµ°æ¨¡å—å®šä¹‰:</p>
<h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•:"></a>é™„å½•:</h2><p>ä¸‰ç«¯åŸºæœ¬ç±»å‹å¯¹åº”:</p>
<table>
<thead>
<tr>
<th style="text-align:left">JS</th>
<th style="text-align:center">iOS</th>
<th style="text-align:right">android</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">string</td>
<td style="text-align:center">NSString</td>
<td style="text-align:right">String</td>
</tr>
<tr>
<td style="text-align:left">number</td>
<td style="text-align:center">NSNumber</td>
<td style="text-align:right">Number</td>
</tr>
<tr>
<td style="text-align:left">float</td>
<td style="text-align:center">float/CGFloat</td>
<td style="text-align:right">float</td>
</tr>
<tr>
<td style="text-align:left">double</td>
<td style="text-align:center">double</td>
<td style="text-align:right">double</td>
</tr>
<tr>
<td style="text-align:left">object</td>
<td style="text-align:center">NSDictionary</td>
<td style="text-align:right">ReadableMap</td>
</tr>
<tr>
<td style="text-align:left">array</td>
<td style="text-align:center">NSArray</td>
<td style="text-align:right">ReadableArray</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2018/07/23/React Native/" data-id="cjwkgb27q0006lpzbugsz5or3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ReactNative/">ReactNative</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-è½®æ’­å›¾" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/13/è½®æ’­å›¾/" class="article-date">
  <time datetime="2018-07-12T16:00:00.000Z" itemprop="datePublished">2018-07-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/13/è½®æ’­å›¾/">è‡ªå®šä¹‰è½®æ’­å›¾</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>æ˜¨å¤©æœ‰ä¸ªå°éœ€æ±‚,å®ç°ä¸€æ¡æ ç›®è½®æ’­</p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/%E5%B0%8F%E9%9C%80%E6%B1%82.gif" alt="å°éœ€æ±‚.gif"></p>
<p>æ—¶é—´å……è¶³,å†™ä¸ªå°demo<br>å¯ä»¥è‡ªå·±å®šä¹‰è½®æ’­å›¾ æä¾›å››ä¸ªæ–¹å‘æ»šåŠ¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">typedef NS_ENUM(NSInteger, ViewScrollDirection) &#123;</span><br><span class="line">    /** æœä¸Šæ»š **/</span><br><span class="line">    ViewScrollDirectionUp = 0,</span><br><span class="line">    /** æœä¸‹æ»š **/</span><br><span class="line">    ViewScrollDirectionDown,</span><br><span class="line">    /** æœå·¦æ»š **/</span><br><span class="line">    ViewScrollDirectionLeft,</span><br><span class="line">    /** æœå³æ»š **/</span><br><span class="line">    ViewScrollDirectionRight</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>ç›®å‰æ”¯æŒè‡ªå®šä¹‰è®¾ç½®æ»šåŠ¨çš„è§†å›¾,è§†å›¾åœç•™çš„æ—¶é—´,æ»šåŠ¨æ—¶é—´,æ˜¯å¦æ‹–åŠ¨ç­‰åŠŸèƒ½.</p>
<p>demoæ¯”è¾ƒç®€å• å¦‚å›¾ä¸‹å›¾:<br><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/%E8%BD%AE%E6%92%AD%E5%9B%BE%E7%AE%80%E6%98%93demo.gif" alt="è½®æ’­å›¾ç®€æ˜“demo.gif"></p>
<p>demoåœ°å€:<a href="https://github.com/weskhen/CarouselPlugin" target="_blank" rel="noopener">https://github.com/weskhen/CarouselPlugin</a></p>
<p>æ”¯æŒpod:  <strong>pod: â€˜CarouselPluginâ€™</strong> </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2018/07/13/è½®æ’­å›¾/" data-id="cjwkgb282000mlpzbpuc2s45l" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/è½®æ’­å›¾/">è½®æ’­å›¾</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-podç§æœ‰åº“çš„æ­å»ºä½¿ç”¨" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/11/podç§æœ‰åº“çš„æ­å»ºä½¿ç”¨/" class="article-date">
  <time datetime="2018-06-10T16:00:00.000Z" itemprop="datePublished">2018-06-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/11/podç§æœ‰åº“çš„æ­å»ºä½¿ç”¨/">podç§æœ‰åº“æ­å»ºåŠä½¿ç”¨(gitee)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>pod åŸºç¡€å®‰è£…(å¿…è¦æ¡ä»¶,è¿™è¾¹å°±ä¸è¯´äº†),å»ºç«‹åœ¨ä½ èƒ½pod æ–‡ä»¶çš„å‰æä¸‹.</p>
<p>å‘½ä»¤è¡Œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo list</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å½“å‰reposä¸‹çš„ç›®å½•: masterå…±æœ‰åº“,å…¶ä»–æ–‡ä»¶å¤¹(ç§æœ‰åº“).<br>æˆ‘ä»¬åœ¨æ‰§è¡Œ<code>pod search xx</code>å‘½ä»¤æ—¶,ä¼šåœ¨reposä¸‹æŸ¥è¯¢</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">- Type: git (master)</span><br><span class="line">- URL:  https://github.com/CocoaPods/Specs.git</span><br><span class="line">- Path: /Users/weskhen/.cocoapods/repos/master</span><br><span class="line"></span><br><span class="line">my-repo</span><br><span class="line">- Type: git (master)</span><br><span class="line">- URL:  https://gitee.com/wesk/my-repo</span><br><span class="line">- Path: /Users/weskhen/.cocoapods/repos/my-repo</span><br></pre></td></tr></table></figure>
<p>åªè¦å®‰è£…å¹¶ä½¿ç”¨è¿‡podçš„,masteræ˜¯ä¸€å®šå­˜åœ¨çš„, my-repoæ˜¯æˆ‘çš„ç§æœ‰åº“,éœ€è¦è‡ªå·±åˆ›å»º,æ€ä¹ˆåˆ›å»ºè¿™ä¸ªå‘¢? ä»ä¸Šçœ‹åˆ°æˆ‘ä½¿ç”¨çš„ä¸ªäººåº“æ˜¯gitee.com. å› ä¸ºè¿™ä¸ªæ˜¯å…è´¹çš„(æœ€å¤š5ä¸ªå¼€å‘è€…å…¬ç”¨).</p>
<ol>
<li><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªgitçš„è´¦å·,è¿™é‡Œä»¥giteeä¸ºä¾‹,åˆ›å»ºé¡¹ç›®,ç‚¹å‡»å³ä¸Šè§’å›¾æ ‡â€œ+â€<br><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/2906485-163b1c483317d31f.png?" alt="gitee-createProject.png"></p>
<p>æ–°å»ºé¡¹ç›®:å¡«å†™å„é¡¹,åœ¨ â€œæ˜¯å¦å¼€æºâ€ é€‰æ‹© ç§æœ‰ å¦‚å›¾:,<br><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/2906485-a96a62ee358da5f7.png" alt="gitee-private.png"><br>å®Œæˆåç‚¹å‡»â€œåˆ›å»ºâ€.<br>è¿™æ ·æˆ‘ä»¬èƒ½çœ‹åˆ°é¡¹ç›®çš„åœ°å€äº†.<br>å¦‚:<a href="https://gitee.com/wesk/xxx" target="_blank" rel="noopener">https://gitee.com/wesk/xxx</a><br>æˆ‘ä»¬è¿™ä¸ªåœ°å€ä½œä¸ºæˆ‘ä»¬ç§æœ‰åº“çš„è¿œç¨‹repoåœ°å€.</p>
</li>
<li><p>gitå‘½ä»¤cloneè¿œç¨‹åº“åˆ°æœ¬åœ°<br>pod repo add my-repo <a href="https://gitee.com/wesk/xxx" target="_blank" rel="noopener">https://gitee.com/wesk/xxx</a></p>
<p>ç¬¬ä¸€æ¬¡æ·»åŠ ä¼šéªŒè¯giteeçš„userNameå’Œpassword. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wujian-2:~ weskhen$ pod repo add my-repo https://gitee.com/wesk/my-repo</span><br><span class="line">Cloning spec repo `my-repo` from `https://gitee.com/wesk/my-repo`</span><br></pre></td></tr></table></figure>
<p>pod repo remove xxx<br>ç§»é™¤æœ¬åœ°æŒ‡å®šçš„è¿œç¨‹åº“<br>å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wujian-2:~ weskhen$ pod repo remove my-repoSec</span><br><span class="line">Removing spec repo `my-repoSec`</span><br></pre></td></tr></table></figure>
<p>pod repo update xxx<br>ç”¨äºæ›´æ–°xxx ç§æœ‰åº“çš„å‘½ä»¤ å¤šäººå¼€å‘çš„æ—¶å€™ä¼šç”¨åˆ°<br>å¦‚:pod repo update my-repo</p>
</li>
<li><p>æ›´æ–°ç‹¬ç«‹çš„é¡¹ç›®(xx.podspec)æ–‡ä»¶ åˆ°my-repo å³ç»„ä»¶åŒ–<br>è¿™ä¸ªæµç¨‹ç½‘ä¸Šåº”è¯¥å¾ˆå¤šäº†,å½“æ—¶åšè¿™çš„æ—¶å€™ä¹Ÿæ˜¯æŸ¥é˜…ç›¸å…³èµ„æ–™çš„.è¿™è¾¹ç®€å•è¯´ä¸‹æµç¨‹ç›¸å…³çš„å‘½ä»¤<br>1.åˆ›å»ºç¼–è¾‘.podspecå‘½ä»¤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod spec create xx</span><br></pre></td></tr></table></figure>
<p>2.å°†é¡¹ç›®æ‰“æˆtagå‘½ä»¤: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git tag -a 1.0 -m &quot;v1.0&quot;</span><br><span class="line">git push origin master</span><br><span class="line">git push origin --tag</span><br></pre></td></tr></table></figure>
<p>3.éªŒè¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pod spec lint xx.podspec</span><br><span class="line">     //è¡¥å……:  å¦‚æœæœ‰æœ¬åœ°ç§æœ‰åº“æº éªŒè¯æ—¶éœ€è¦åŠ å…¥ç§æœ‰æºå’Œå®˜æ–¹æº</span><br><span class="line"> pod spec lint KKLDBService.podspec --sources=&apos;https://gitee.com/wesk/my-repo,https://github.com/CocoaPods/Specs.git&apos;</span><br></pre></td></tr></table></figure>
<p>4.å‘å¸ƒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo push my-repo xx.podspec --allow-warnings</span><br></pre></td></tr></table></figure>
<p>åç¼€â€“allow-warnings ä»£è¡¨å¿½ç•¥è­¦å‘Š<br>åç¼€â€“use-libraries ä»£è¡¨ä½¿ç”¨é™æ€åº“ ç»„å»ºè‹¥ä½¿ç”¨äº†.aé™æ€åº“,éœ€è¦åŠ ä¸Šè¿™ä¸ª.</p>
<ol start="4">
<li><p>é¡¹ç›®ä¸­çš„ä½¿ç”¨<br>åœ¨podfileæ–‡ä»¶ä¸­ é¡¶éƒ¨æ·»åŠ :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å®˜æ–¹æº: source &apos;https://github.com/CocoaPods/Specs.git&apos;</span><br><span class="line">ç§æœ‰æº: source &apos;https://gitee.com/wesk/my-repo&apos;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>ä½ ä¹Ÿå¯ä»¥åœ¨å…·ä½“çš„ç»„ä»¶å¤„æŒ‡å®šæº,å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pod &apos;xxxx&apos;, :git =&gt;&apos;https://gitee.com/wesk/my-repo&apos;</span><br><span class="line">&lt;!--æˆ–--&gt;</span><br><span class="line">pod &apos;xxx&apos;, :podspec =&gt; &apos;xxxx.podspec&apos;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>æœ€åæ›´æ–°podfileæ–‡ä»¶å³å¯å•¦</p>
<p>ç§æœ‰åº“çš„ä½¿ç”¨å·®ä¸å¤šå°±è¿™æ ·äº†,é‡è¦çš„æ˜¯è¿™ä¸ªæµç¨‹å’Œç›¸åº”çš„å‘½ä»¤.è‹¥ä½¿ç”¨å…¬å¸çš„é¡¹ç›®,ä»ç¬¬äºŒæ­¥å¼€å§‹å³å¯.</p>
<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2018/06/11/podç§æœ‰åº“çš„æ­å»ºä½¿ç”¨/" data-id="cjwkgb27y000flpzbz9wipooc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pod/">pod</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ç§æœ‰åº“/">ç§æœ‰åº“</a></li></ul>

    </footer>
  </div>
  
</article>




  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/ReactNative/">ReactNative</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/ç½‘ç»œ/">ç½‘ç»œ</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/MSL/">MSL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSNumberFormatter/">NSNumberFormatter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSProxy/">NSProxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSURLSession/">NSURLSession</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RN-Bug/">RN-Bug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RTT/">RTT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactNative/">ReactNative</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TTL/">TTL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XCodeæŠ¥é”™/">XCodeæŠ¥é”™</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/appå‘å¸ƒ/">appå‘å¸ƒ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOSèµ„æ–™/">iOSèµ„æ–™</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pod/">pod</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ä»£ç è§„èŒƒ/">ä»£ç è§„èŒƒ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/åŸ‹ç‚¹/">åŸ‹ç‚¹</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç§æœ‰åº“/">ç§æœ‰åº“</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è½®æ’­å›¾/">è½®æ’­å›¾</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/é˜¿é‡Œäº‘æ—¥å¿—/">é˜¿é‡Œäº‘æ—¥å¿—</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/é¢è¯•/">é¢è¯•</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/MSL/" style="font-size: 10px;">MSL</a> <a href="/tags/NSNumberFormatter/" style="font-size: 10px;">NSNumberFormatter</a> <a href="/tags/NSProxy/" style="font-size: 10px;">NSProxy</a> <a href="/tags/NSURLSession/" style="font-size: 10px;">NSURLSession</a> <a href="/tags/RN-Bug/" style="font-size: 10px;">RN-Bug</a> <a href="/tags/RTT/" style="font-size: 10px;">RTT</a> <a href="/tags/ReactNative/" style="font-size: 10px;">ReactNative</a> <a href="/tags/TTL/" style="font-size: 10px;">TTL</a> <a href="/tags/XCodeæŠ¥é”™/" style="font-size: 10px;">XCodeæŠ¥é”™</a> <a href="/tags/appå‘å¸ƒ/" style="font-size: 10px;">appå‘å¸ƒ</a> <a href="/tags/iOSèµ„æ–™/" style="font-size: 10px;">iOSèµ„æ–™</a> <a href="/tags/pod/" style="font-size: 10px;">pod</a> <a href="/tags/ä»£ç è§„èŒƒ/" style="font-size: 10px;">ä»£ç è§„èŒƒ</a> <a href="/tags/åŸ‹ç‚¹/" style="font-size: 10px;">åŸ‹ç‚¹</a> <a href="/tags/ç§æœ‰åº“/" style="font-size: 10px;">ç§æœ‰åº“</a> <a href="/tags/è½®æ’­å›¾/" style="font-size: 10px;">è½®æ’­å›¾</a> <a href="/tags/é˜¿é‡Œäº‘æ—¥å¿—/" style="font-size: 10px;">é˜¿é‡Œäº‘æ—¥å¿—</a> <a href="/tags/é¢è¯•/" style="font-size: 10px;">é¢è¯•</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/06/06/iOS13ç³»ç»Ÿé€‚é…/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/05/22/é˜¿é‡Œäº‘æ—¥å¿—ä¸Šä¼ åŠæ— ç—•åŸ‹ç‚¹/">æ— ç—•åŸ‹ç‚¹åŠä¸ŠæŠ¥é˜¿é‡Œäº‘æ—¥å¿—</a>
          </li>
        
          <li>
            <a href="/2019/02/23/NSNumberFormatter/">NSNumberFormatterçš„ç®€å•ä½¿ç”¨</a>
          </li>
        
          <li>
            <a href="/2019/02/23/MSLã€TTLå’ŒRTTç®€ä»‹/">MSLã€TTLå’ŒRTTç®€ä»‹</a>
          </li>
        
          <li>
            <a href="/2019/02/23/reactæºç ä¿®æ”¹è®°å½•/">reactæºç ä¿®æ”¹è®°å½•</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 weskç—•<br>
      <!-- Powered by <a href="http://weskhen.xyz" target="_blank">Wesk</a> -->
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>