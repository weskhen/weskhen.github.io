<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>面朝大海,想代码</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="证明我一下,我还活着...">
<meta property="og:type" content="website">
<meta property="og:title" content="面朝大海,想代码">
<meta property="og:url" content="http://weskhen.xyz/page/2/index.html">
<meta property="og:site_name" content="面朝大海,想代码">
<meta property="og:description" content="证明我一下,我还活着...">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="面朝大海,想代码">
<meta name="twitter:description" content="证明我一下,我还活着...">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">

    <div id="header-title" class="inner">

      <h1 id="logo-wrap">
        <a href="/" id="logo">面朝大海,想代码</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">挺好的</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://weskhen.xyz"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-NSProxy" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/23/NSProxy/" class="article-date">
  <time datetime="2019-01-22T16:00:00.000Z" itemprop="datePublished">2019-01-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/23/NSProxy/">NSProxy简介</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="NSProxy是什么"><a href="#NSProxy是什么" class="headerlink" title="NSProxy是什么?"></a>NSProxy是什么?</h2><p><code>NSProxy</code> 是NSProxy 是一个<strong>抽象类</strong>,跟 <code>NSObject</code> 一样的基类，都遵守<code>&lt;NSObject&gt;</code>协议</p>
<p><code>NSProxy</code>是一个抽象类，必须继承实例化其子类才能使用。</p>
<p><code>NSProxy</code>从类名来看是代理类专门负责代理对象转发消息的。相比<code>NSObject</code>类来说<code>NSProxy</code>更轻量级，通过<code>NSProxy</code>可以帮助<code>Objective-C</code>间接的实现多重继承的功能。</p>
<h2 id="消息转发机制"><a href="#消息转发机制" class="headerlink" title="消息转发机制"></a>消息转发机制</h2><p>当程序运行时调用一个没有实现的方法，会采用三个消息转发步骤如果这三个步骤都不能成功那么此时程序会抛出一个异常。</p>
<p>1.添加方法到类对象，对于实例方法调用respondsToSelector:，对于类方法调用resolveClassMethod:。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ (BOOL)resolveClassMethod:(SEL)sel;</span><br><span class="line">- (BOOL)respondsToSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<p>2.查找forwardingTargetForSelector:方法，该方法返回一个新对象，如果返回nil那么将跳转到下一步骤。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (id)forwardingTargetForSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure>
<p>3.通过methodSignatureForSelector:方法获取一个NSMethodSignature类型的对象，调用forwardInvocation:方法。改方法传入一个封装了NSMethodSignature的NSInvocation对象。然后该对象通过invakeWithTarget:方法将消息转发给其它对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector;</span><br><span class="line"></span><br><span class="line">- (void)forwardInvocation:(NSInvocation *)invocation;</span><br></pre></td></tr></table></figure>
<h2 id="NSProxy-和-NSObject-的比较"><a href="#NSProxy-和-NSObject-的比较" class="headerlink" title="NSProxy 和 NSObject 的比较"></a>NSProxy 和 NSObject 的比较</h2><p>相比NSObject,NSProxy更轻量级,  做消息转发效率更高.</p>
<p>NSObject寻找方法顺序：本类-&gt;(父类-)&gt;(动态方法解析)-&gt; 消息转发；<br>NSproxy顺序：本类-&gt;消息转发</p>
<h2 id="NSProxy的用途"><a href="#NSProxy的用途" class="headerlink" title="NSProxy的用途"></a>NSProxy的用途</h2><ol>
<li><p>AOP面向切片编程</p>
<p>iOS中面向切片编程一般有两种方式 ，一个是直接基于runtime 的method-Swizzling.还有一种就是基于NSProxy</p>
</li>
<li><p>解决NSTimer, CADisplayLink等强引用target引起的无法释放问题。如NSTimer:利用消息转发来断开NSTimer对象与视图之间的强引用关系。初始化NSTimer时把触发事件的target替换成一个单独的对象，然后这个对象中NSTimer的SEL方法触发时让这个方法在当前的视图self中实现。</p>
</li>
<li><p>多重继承</p>
<p>实现类似CAAnimation类族.</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2019/01/23/NSProxy/" data-id="cjzyuzxcq0005euzbh2dc4q16" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NSProxy/">NSProxy</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-React Native" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/23/React Native/" class="article-date">
  <time datetime="2018-07-22T16:00:00.000Z" itemprop="datePublished">2018-07-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/23/React Native/">React Native 方案预研</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-RN跳转Native的路由"><a href="#1-RN跳转Native的路由" class="headerlink" title="1. RN跳转Native的路由"></a>1. RN跳转Native的路由</h2><p>路由在项目中主要作用有:</p>
<ol>
<li>降低App页面之间的耦合性。随着项目越来越复杂，各个组件和页面之间的跳转也变得越来越复杂，他们之间的跳转逻辑也变的越来越紧密，这就造成了各个模块的相互依赖越来越紧密</li>
<li>大前端页面跳转的一致性.</li>
<li>可以通过动态下发配置表来配置App的跳转逻辑。这样iOS和Android两边只要共用一套配置文件，通过下发修改后配置表也能实现动态的改变映射目标。</li>
</ol>
<h3 id="路由的定义"><a href="#路由的定义" class="headerlink" title="路由的定义"></a>路由的定义</h3><p>路由的定义有很多种,为了兼容项目之前的路由定义,rn路由定义如下:</p>
<p>jsonStirng = {“methodName”:”methodName”,”data”:{} }</p>
<p>方法名:<code>methodName</code>  路由的方法名,如Notification_callNativeEvent, 通知模块, 调用原生通知</p>
<p>参数:<code>data</code> 是一个map结构,用于react向native传的参数.</p>
<p>忽略:methodName格式: “moduleName_action”</p>
<h3 id="和js与native路由的比较"><a href="#和js与native路由的比较" class="headerlink" title="和js与native路由的比较:"></a>和js与native路由的比较:</h3><ul>
<li>js与native中有<code>callbackId</code>,但是这里没有了, 因为react调用native有个promise的返回体,请求和返回是一一对应的.</li>
</ul>
<p>react发出encode后的jsonStirng, native获取jsonStirng后decode,根据规则解析出对应的部分.</p>
<p>数据传输的流程图如下:</p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/006tKfTcly1g19d0bqpy4j30mu0ruabk.jpg" alt="image-20190320165306011"></p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/006tKfTcly1g19d0tdcuzj30h80iemyf.jpg" alt="image-20190320165334729"></p>
<h2 id="2-Native进入RN或者H5"><a href="#2-Native进入RN或者H5" class="headerlink" title="2. Native进入RN或者H5"></a>2. Native进入RN或者H5</h2><p>比如在首页点击Banner跳转，可以跳转H5也可以跳转到RN，可以通过解析后台下发的Url来决定跳转的目标。<br>确定跳转RN的协议定位为 <code>react://module/acion?params</code>,其中<br><code>react://</code>确定跳转的是RN页面，<code>module/action</code>表示跳转的模块和对应的action，<code>params</code>是传入的参数。<br>流程图参考 <code>RN的降级</code></p>
<h2 id="3-RN的降级"><a href="#3-RN的降级" class="headerlink" title="3. RN的降级"></a>3. RN的降级</h2><p>在react-native页面中捕获异常,捕获到异常我们会记录异常灰度，并对业务进行降级跳转到H5页面.  RN页面和H5页面跳转机制以及后台可配置方案:</p>
<p>针对后端控制的跳转rn页面,服务器下发路由地址{firstUrl:  secondUrl: }  优先字段和备选字段 (选择跳转rn页面还是h5页面)。 <code>流程图</code> </p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/006tKfTcly1g19d0lm30nj30ej0mwdh8.jpg" alt="image-20190320165322408"></p>
<p>上图中的加载失败的原因有多种: </p>
<ul>
<li><p>module注册为空,选用h5</p>
</li>
<li><p>业务场景严重问题,选用h5</p>
</li>
</ul>
<p>在实际业务中,降级方案可以放到后面,因为有热更新机制, 大部分问题可以及时修复且更新….</p>
<h2 id="4-热更新功能"><a href="#4-热更新功能" class="headerlink" title="4. 热更新功能"></a>4. 热更新功能</h2><p>热更新是RN的非常重要的一个功能特性,<code>Code-Push</code>,我们在之前的版本中已经集成并开始使用了.这边就不阐述了.</p>
<p>接下来:我们会开发维护起自己的codepush服务地址,更好的控制rn版本.如测试环境Code-Push登录: <a href="http://10.0.0.115:3001/" target="_blank" rel="noopener">http://10.0.0.115:3001/</a> </p>
<h4 id="注意"><a href="#注意" class="headerlink" title="注意:"></a>注意:</h4><ul>
<li>苹果不允许应用内有弹框提示更新</li>
</ul>
<h2 id="5-RN的业务基础组件建立"><a href="#5-RN的业务基础组件建立" class="headerlink" title="5. RN的业务基础组件建立"></a>5. RN的业务基础组件建立</h2><p>因为安卓和iOS两个平台的差异性, 有些UI组件的特性不一致,需要区分开来判断,RN自己提供的组件库还无法满足我们的实际的业务需求,所有我们需要自己来进行封装,以方便业务开发.</p>
<p>计划:随着业务开发迭代,逐渐形成xhx自己的一套RN组件库.</p>
<h2 id="6-RN在项目中的应用场景"><a href="#6-RN在项目中的应用场景" class="headerlink" title="6. RN在项目中的应用场景"></a>6. RN在项目中的应用场景</h2><p>由于RN在使用的时候,会占据一定的内存空间, 不推荐使用在全局静态的地方,因为安卓机app使用内存受限,如果RN的功能模块常驻后台,会影响其他功能的使用.</p>
<p>RN在原生app中入口:</p>
<ul>
<li>固定入口的跳转</li>
<li>服务器下发的url识别跳转, 如点击首页banner,识别url属于rn的路由地址.</li>
</ul>
<p>功能、页面 走路由,组件走模块定义:</p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录:"></a>附录:</h2><p>三端基本类型对应:</p>
<table>
<thead>
<tr>
<th style="text-align:left">JS</th>
<th style="text-align:center">iOS</th>
<th style="text-align:right">android</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">string</td>
<td style="text-align:center">NSString</td>
<td style="text-align:right">String</td>
</tr>
<tr>
<td style="text-align:left">number</td>
<td style="text-align:center">NSNumber</td>
<td style="text-align:right">Number</td>
</tr>
<tr>
<td style="text-align:left">float</td>
<td style="text-align:center">float/CGFloat</td>
<td style="text-align:right">float</td>
</tr>
<tr>
<td style="text-align:left">double</td>
<td style="text-align:center">double</td>
<td style="text-align:right">double</td>
</tr>
<tr>
<td style="text-align:left">object</td>
<td style="text-align:center">NSDictionary</td>
<td style="text-align:right">ReadableMap</td>
</tr>
<tr>
<td style="text-align:left">array</td>
<td style="text-align:center">NSArray</td>
<td style="text-align:right">ReadableArray</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2018/07/23/React Native/" data-id="cjzyuzxcu0007euzbgfjj0s35" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ReactNative/">ReactNative</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-轮播图" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/13/轮播图/" class="article-date">
  <time datetime="2018-07-12T16:00:00.000Z" itemprop="datePublished">2018-07-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/07/13/轮播图/">自定义轮播图</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>昨天有个小需求,实现一条栏目轮播</p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/%E5%B0%8F%E9%9C%80%E6%B1%82.gif" alt="小需求.gif"></p>
<p>时间充足,写个小demo<br>可以自己定义轮播图 提供四个方向滚动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">typedef NS_ENUM(NSInteger, ViewScrollDirection) &#123;</span><br><span class="line">    /** 朝上滚 **/</span><br><span class="line">    ViewScrollDirectionUp = 0,</span><br><span class="line">    /** 朝下滚 **/</span><br><span class="line">    ViewScrollDirectionDown,</span><br><span class="line">    /** 朝左滚 **/</span><br><span class="line">    ViewScrollDirectionLeft,</span><br><span class="line">    /** 朝右滚 **/</span><br><span class="line">    ViewScrollDirectionRight</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>目前支持自定义设置滚动的视图,视图停留的时间,滚动时间,是否拖动等功能.</p>
<p>demo比较简单 如图下图:<br><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/%E8%BD%AE%E6%92%AD%E5%9B%BE%E7%AE%80%E6%98%93demo.gif" alt="轮播图简易demo.gif"></p>
<p>demo地址:<a href="https://github.com/weskhen/CarouselPlugin" target="_blank" rel="noopener">https://github.com/weskhen/CarouselPlugin</a></p>
<p>支持pod:  <strong>pod: ‘CarouselPlugin’</strong> </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2018/07/13/轮播图/" data-id="cjzyuzxd7000neuzbriy8xu8p" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/轮播图/">轮播图</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-pod私有库的搭建使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/11/pod私有库的搭建使用/" class="article-date">
  <time datetime="2018-06-10T16:00:00.000Z" itemprop="datePublished">2018-06-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/11/pod私有库的搭建使用/">pod私有库搭建及使用(gitee)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>pod 基础安装(必要条件,这边就不说了),建立在你能pod 文件的前提下.</p>
<p>命令行:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo list</span><br></pre></td></tr></table></figure>
<p>查看当前repos下的目录: master共有库,其他文件夹(私有库).<br>我们在执行<code>pod search xx</code>命令时,会在repos下查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">- Type: git (master)</span><br><span class="line">- URL:  https://github.com/CocoaPods/Specs.git</span><br><span class="line">- Path: /Users/weskhen/.cocoapods/repos/master</span><br><span class="line"></span><br><span class="line">my-repo</span><br><span class="line">- Type: git (master)</span><br><span class="line">- URL:  https://gitee.com/wesk/my-repo</span><br><span class="line">- Path: /Users/weskhen/.cocoapods/repos/my-repo</span><br></pre></td></tr></table></figure>
<p>只要安装并使用过pod的,master是一定存在的, my-repo是我的私有库,需要自己创建,怎么创建这个呢? 从上看到我使用的个人库是gitee.com. 因为这个是免费的(最多5个开发者公用).</p>
<ol>
<li><p>首先创建一个git的账号,这里以gitee为例,创建项目,点击右上角图标“+”<br><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/2906485-163b1c483317d31f.png?" alt="gitee-createProject.png"></p>
<p>新建项目:填写各项,在 “是否开源” 选择 私有 如图:,<br><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/2906485-a96a62ee358da5f7.png" alt="gitee-private.png"><br>完成后点击“创建”.<br>这样我们能看到项目的地址了.<br>如:<a href="https://gitee.com/wesk/xxx" target="_blank" rel="noopener">https://gitee.com/wesk/xxx</a><br>我们这个地址作为我们私有库的远程repo地址.</p>
</li>
<li><p>git命令clone远程库到本地<br>pod repo add my-repo <a href="https://gitee.com/wesk/xxx" target="_blank" rel="noopener">https://gitee.com/wesk/xxx</a></p>
<p>第一次添加会验证gitee的userName和password. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wujian-2:~ weskhen$ pod repo add my-repo https://gitee.com/wesk/my-repo</span><br><span class="line">Cloning spec repo `my-repo` from `https://gitee.com/wesk/my-repo`</span><br></pre></td></tr></table></figure>
<p>pod repo remove xxx<br>移除本地指定的远程库<br>如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wujian-2:~ weskhen$ pod repo remove my-repoSec</span><br><span class="line">Removing spec repo `my-repoSec`</span><br></pre></td></tr></table></figure>
<p>pod repo update xxx<br>用于更新xxx 私有库的命令 多人开发的时候会用到<br>如:pod repo update my-repo</p>
</li>
<li><p>更新独立的项目(xx.podspec)文件 到my-repo 即组件化<br>这个流程网上应该很多了,当时做这的时候也是查阅相关资料的.这边简单说下流程相关的命令<br>1.创建编辑.podspec命令:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod spec create xx</span><br></pre></td></tr></table></figure>
<p>2.将项目打成tag命令: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git tag -a 1.0 -m &quot;v1.0&quot;</span><br><span class="line">git push origin master</span><br><span class="line">git push origin --tag</span><br></pre></td></tr></table></figure>
<p>3.验证</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pod spec lint xx.podspec</span><br><span class="line">     //补充:  如果有本地私有库源 验证时需要加入私有源和官方源</span><br><span class="line"> pod spec lint KKLDBService.podspec --sources=&apos;https://gitee.com/wesk/my-repo,https://github.com/CocoaPods/Specs.git&apos;</span><br></pre></td></tr></table></figure>
<p>4.发布</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo push my-repo xx.podspec --allow-warnings</span><br></pre></td></tr></table></figure>
<p>后缀–allow-warnings 代表忽略警告<br>后缀–use-libraries 代表使用静态库 组建若使用了.a静态库,需要加上这个.</p>
<ol start="4">
<li><p>项目中的使用<br>在podfile文件中 顶部添加:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">官方源: source &apos;https://github.com/CocoaPods/Specs.git&apos;</span><br><span class="line">私有源: source &apos;https://gitee.com/wesk/my-repo&apos;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>你也可以在具体的组件处指定源,如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pod &apos;xxxx&apos;, :git =&gt;&apos;https://gitee.com/wesk/my-repo&apos;</span><br><span class="line">&lt;!--或--&gt;</span><br><span class="line">pod &apos;xxx&apos;, :podspec =&gt; &apos;xxxx.podspec&apos;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>最后更新podfile文件即可啦</p>
<p>私有库的使用差不多就这样了,重要的是这个流程和相应的命令.若使用公司的项目,从第二步开始即可.</p>
<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2018/06/11/pod私有库的搭建使用/" data-id="cjzyuzxd3000geuzb8rl8j7ov" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pod/">pod</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/私有库/">私有库</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-NSURLSession" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/23/NSURLSession/" class="article-date">
  <time datetime="2018-01-22T16:00:00.000Z" itemprop="datePublished">2018-01-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/23/NSURLSession/">NSURLSession</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>为什么聊NSURLSession,因为公司内部分享会上,有同事分享了AFNetworking,不可避免的谈到的2.0-3.0的变动,请求类方式从NSURLConnection到NSURLsession,那谈到了为什么有这个变动?有哪些变动?怎么使用NSURLsession? 在谈一个为什么有这个变动时大家出现了分歧:</p>
<ol>
<li><p>session在使用的时候,可以重用上一次tcp握手链接 </p>
</li>
<li><p>session和cookies联系,session单利的好处</p>
</li>
</ol>
<h4 id="HTTP版本"><a href="#HTTP版本" class="headerlink" title="HTTP版本"></a>HTTP版本</h4><p>谈以上话题之前,先来看一下HTTP版本相关的几点知识:<br>这里我把HTTP版本简单分为三类：1.1之前，1.1，2.0，针对这三类做个主要差异的介绍：</p>
<blockquote>
<p>HTTP 1.1之前</p>
</blockquote>
<ul>
<li>不支持持久连接。一旦服务器对客户端发出响应就立即断开TCP连接</li>
<li>无请求头跟响应头</li>
<li>客户端的前后请求是同步的。下一个请求必须等上一个请求从服务端拿到响应后才能发出，有点类似多线程的同步机制。</li>
</ul>
<blockquote>
<p> HTTP 1.1(主流版本)</p>
</blockquote>
<p>与1.1之前的版本相比，做了以下性能上的提升</p>
<ul>
<li>增加请求头跟响应头</li>
<li>支持持久连接。客户端通过请求头中指定<strong>Connection</strong>为<strong>keep-alive</strong>告知服务端不要在完成响应后立即释放连接。HTTP是基于TCP的，在HTTP 1.1中一次TCP连接可以处理多次HTTP请求(keep-alive 有效时间内)</li>
<li>客户端不同请求之间是异步的。下一个请求不必等到上一个请求回来后再发出，而可以连续发出请求，有点类似多线程的异步处理。</li>
</ul>
<blockquote>
<p>HTTP 2.0 (趋势)</p>
</blockquote>
<ul>
<li>HTTP/2采用二进制格式而非文本格式</li>
<li>HTTP/2是完全多路复用的，而非有序并阻塞的——只需一个连接即可实现并行</li>
<li>使用报头压缩，HTTP/2降低了开销</li>
<li>HTTP/2让服务器可以将响应主动“推送”到客户端缓存中</li>
<li>2.0将只用于https网址。</li>
</ul>
<p>我们重点关注一下当前1.1版本所做几点改变。支持持久连接有什么好处呢？HTTP是基于TCP连接的，如果连接被频繁地启动然后断开就会花费很多资源在TCP三次握手以及四次挥手上，效率低下。以请求一个网页为例，我们知道，一个html网页上的图片资源并不是直接嵌入在网页上，而只是提供url，图片仍需要额外发HTTP 请求去下载。一个网页从请求到最终加载到本地往往需要经过多个HTTP请求。在1.1版本之前请求一个网页就需要发生多次”握手-挥手”的过程，每次连接之间相互独立；而1.1及之后的版本最少只需要一次就够。<br>再来就是请求异步，其好处参考多线程异步处理，在此不展开。</p>
<p>http1.1 请求实际步骤如下图：</p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/NSURLSession01.png" alt="图1 session设置了每个host最大的请求线程数为1"></p>
<p>上图session设置了每个host最大的请求线程数为1:</p>
<p><img src="https://github.com/weskhen/weskhen.github.io/raw/master/image/NSURLSession02.png" alt="图2 session设置了每个host最大的请求线程数为2"></p>
<p>上图:session设置了每个host最大的请求线程数为2</p>
<p>我们可以看到：</p>
<p> 1、多次请求其实只建立了1次TCP连接</p>
<p> 2、多次请求连续可以异步发出。</p>
<p> so,能重用上一次tcp握手链接的是因为http协议更新到http1.1后.同一个session可以在keep-alive有效时间内不断开链接.</p>
<h4 id="NSURLSessionConfiguration-NSURLSession中重要的属性"><a href="#NSURLSessionConfiguration-NSURLSession中重要的属性" class="headerlink" title="NSURLSessionConfiguration(NSURLSession中重要的属性)"></a>NSURLSessionConfiguration(NSURLSession中重要的属性)</h4><p> 有三个方法来创建NSURLSessionConfiguration:</p>
<ul>
<li><p>defaultSessionConfiguration 使用全局的cache，<strong>cookie</strong>,使用硬盘来缓存数据。</p>
<p>cookie和cache类似,都有一个默认的单例获取对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSHTTPCookieStorage *cookieStorage = [NSHTTPCookieStorage sharedHTTPCookieStorage];</span><br></pre></td></tr></table></figure>
<p>但有点不同,苹果给开发者cookie的操作权限不如cache,sharedHTTPCookieStorage只是个读属性</p>
</li>
</ul>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> </span><br></pre></td></tr></table></figure>
<ul>
<li><p>ephemeralSessionConfiguration 临时session配置，与默认配置相比，这个配置不会将缓存、cookie等存在本地，只会存在内存里，所以当程序退出时，所有的数据都会消失,浏览器无痕模式</p>
</li>
<li><p>backgroundSessionConfiguration 后台session配置,需要设置唯一标识，与默认配置类似，不同的是会在后台开启另一个线程来处理网络数据,app杀进程session会断开,重新启动后,session会重新建立.</p>
</li>
</ul>
<p>/<em> 是否使用蜂窝网络，默认是yes. </em>/<br>@property BOOL allowsCellularAccess;</p>
<p>/<em><br>指定了一组默认的可以设置出站请求的数据头。这对于跨会话共享信息，如内容类型，语言，用户代理，身份认证，是很有用的。<br>例如：<br>    @{@”Accept”: @”application/json”,<br>     @”Accept-Language”: @”en”,<br>     @”Authorization”: authString,<br>     @”User-Agent”: userAgentString<br>   }
 </em>/<br>@property (nullable, copy) NSDictionary *HTTPAdditionalHeaders;</p>
<p>/<em><br>同时连接一个host的最大数。iOS默认是4.APP是作为一个整体来看的
 </em>/<br>@property NSInteger HTTPMaximumConnectionsPerHost;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2018/01/23/NSURLSession/" data-id="cjzyuzxcs0006euzbupokcnsg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NSURLSession/">NSURLSession</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-本地app发布下载" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/29/本地app发布下载/" class="article-date">
  <time datetime="2017-04-28T16:00:00.000Z" itemprop="datePublished">2017-04-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/29/本地app发布下载/">mac 搭建apache https服务器 用于本地app发布</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>先 cd <code>/Library/WebServer/Documents/</code> 这个是Mac下 web的目录 </p>
<p>可以新建一个ios的文件路径 <code>sudo mkdir ios</code></p>
<p>cd ios 文件下 开始执行以下操作</p>
<p>a-生成私钥，命令： <code>sudo openssl genrsa -des3 -out app.key 1024</code></p>
<p>b-生成签署申请，命令： <code>sudo openssl req -new -key app.key -out app.csr</code></p>
<p>c-生成服务器的私钥，命令： <code>sudo openssl rsa -in app.key -out server.key</code></p>
<p>d-生成给网站服务器签署的证书，命令： <code>sudo openssl req -new -x509 -days 3650 -key server.key -out server.crt</code></p>
<p>（这一步和a差不多，需要注意的是Common Name一定要填对）</p>
<p>e-拷贝文件至apache目录下 <code>sudo cp server.* /etc/apache2/</code></p>
<p>以下是具体的步骤： </p>
<p>MacBook-Pro:apache2 weskhen$ <code>cd /Library/WebServer/Documents/</code></p>
<p>MacBook-Pro:Documents weskhen$ <code>ls</code></p>
<p>PoweredByMacOSX.gifindex.html.en</p>
<p>PoweredByMacOSXLarge.gifindex.html.en~orig</p>
<p>MacBook-Pro:Documents weskhen$ <code>sudo mkdir ios</code></p>
<p>MacBook-Pro:Documents weskhen$ <code>ls</code></p>
<p>PoweredByMacOSX.gifindex.html.en~orig</p>
<p>PoweredByMacOSXLarge.gifios</p>
<p>index.html.en</p>
<p>MacBook-Pro:Documents weskhen$ <code>cd ios</code></p>
<p>MacBook-Pro:ios weskhen$ <code>sudo openssl genrsa -des3 -out app.key 1024</code></p>
<p>Generating RSA private key, 1024 bit long modulus</p>
<p>..++++++</p>
<p>………++++++</p>
<p>e is 65537 (0x10001)</p>
<p>Enter pass phrase for app.key:</p>
<p>Verifying - Enter pass phrase for app.key:</p>
<p>MacBook-Pro:ios weskhen$ <code>sudo openssl req -new -key app.key -out app.csr</code></p>
<p>Enter pass phrase for app.key:</p>
<p>You are about to be asked to enter information that will be incorporated</p>
<p>into your certificate request.</p>
<p>What you are about to enter is what is called a Distinguished Name or a DN.</p>
<p>There are quite a few fields but you can leave some blank</p>
<p>For some fields there will be a default value,</p>
<p>If you enter ‘.’, the field will be left blank.</p>
<p>-—-</p>
<p>Country Name (2 letter code) [AU]:CN</p>
<p>State or Province Name (full name) [Some-State]:ZheJiang</p>
<p>Locality Name (eg, city) []:hangzhou</p>
<p>Organization Name (eg, company) [Internet Widgits Pty Ltd]:wesk</p>
<p>Organizational Unit Name (eg, section) []:weskhen</p>
<p>Common Name (e.g. server FQDN or YOUR name) []:10.0.0.12</p>
<p>Email Address []:<a href="mailto:wujian516411567@163.com" target="_blank" rel="noopener">wujian516411567@163.com</a></p>
<p>Please enter the following ‘extra’ attributes</p>
<p>to be sent with your certificate request</p>
<p>A challenge password []:000000</p>
<p>An optional company name []:weskhen</p>
<p>MacBook-Pro:ios weskhen$ <code>sudo openssl rsa -in app.key -out server.key</code></p>
<p>Enter pass phrase for app.key:</p>
<p>writing RSA key</p>
<p>MacBook-Pro:ios weskhen$ sudo openssl req -new -x509 -days 3650 -key server.key -out server.crt</p>
<p>You are about to be asked to enter information that will be incorporated</p>
<p>into your certificate request.</p>
<p>What you are about to enter is what is called a Distinguished Name or a DN.</p>
<p>There are quite a few fields but you can leave some blank</p>
<p>For some fields there will be a default value,</p>
<p>If you enter ‘.’, the field will be left blank.</p>
<p>-—-</p>
<p>Country Name (2 letter code) [AU]:CN</p>
<p>State or Province Name (full name) [Some-State]:ZheJiang</p>
<p>Locality Name (eg, city) []:hangzhou</p>
<p>Organization Name (eg, company) [Internet Widgits Pty Ltd]:wesk</p>
<p>Organizational Unit Name (eg, section) []:weskhen</p>
<p>Common Name (e.g. server FQDN or YOUR name) []:<em>10.0.0.12</em></p>
<p>Email Address []:<a href="mailto:wujian516411567@163.com" target="_blank" rel="noopener">wujian516411567@163.com</a></p>
<p>MacBook-Pro:ios weskhen$ ls</p>
<p>app.csrapp.keyserver.crtserver.key</p>
<p>MacBook-Pro:ios weskhen$ <code>sudo cp server.* /etc/apache2/</code></p>
<p>MacBook-Pro:ios weskhen$ <code>ls</code></p>
<p>app.csr app.key server.crt server.key</p>
<p>MacBook-Pro:apache2 weskhen$ <code>sudo apachectl configtest</code></p>
<p>AH00112: Warning: DocumentRoot [/usr/docs/dummy-host.<a href="http://example.com" target="_blank" rel="noopener">example.com</a>] does not exist</p>
<p>AH00112: Warning: DocumentRoot [/usr/docs/dummy-host2.<a href="http://example.com" target="_blank" rel="noopener">example.com</a>] does not exist</p>
<p>Syntax OK</p>
<p>MacBook-Pro:apache2 weskhen$ <code>sudo apachectl restart</code></p>
<p>apachectl configtest //检测 当服务出现问题的时候用这一句检测一下 很有用</p>
<p><strong>2-配置apache，开启ssl</strong></p>
<p>编辑/etc/apache2/httpd.conf文件，去掉下面三行前面的＃号</p>
<p>(/etc/apache2/httpd.conf和/private/etc/apache2/httpd.conf其实是同一个内容)</p>
<p>LoadModule ssl_module libexec/apache2/mod_ssl.so</p>
<p>Include /etc/apache2/extra/httpd-ssl.conf</p>
<p>Include /etc/apache2/extra/httpd-vhosts.conf</p>
<p>编辑/etc/apache2/extra/httpd-ssl.conf文件，去掉下面两行前面的＃号</p>
<p>SSLCertificateFile “/etc/apache2/ssl/server.crt”/</p>
<p>SSLCertificateFile “/private/etc/apache2/ssl/server.crt”</p>
<p>SSLCertificateKeyFile “/etc/apache2/ssl/server.key”/</p>
<p>SSLCertificateKeyFile “/private/etc/apache2/ssl/server.key”</p>
<p>编辑/etc/apache2/extra/httpd-vhosts.conf文件，在NameVirtualHost*:80后面添加一段如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:443&gt;</span><br><span class="line">    SSLEngine on</span><br><span class="line">    SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL</span><br><span class="line">    SSLCertificateFile /etc/apache2/server.crt</span><br><span class="line">    SSLCertificateKeyFile /etc/apache2/server.key</span><br><span class="line">    ServerName 10.0.0.12 </span><br><span class="line">    DocumentRoot &quot;/Library/WebServer/Documents&quot;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure>
<p>10.0.0.12是当前设备局域网内的IP地址</p>
<p><strong>3-配置ipa下载</strong></p>
<p>获取打包后的mainfest.plist文件 如果选择了app thinning 删除 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;;</span><br><span class="line">&lt;plist version=&quot;1.0&quot;&gt;</span><br><span class="line">&lt;dict&gt;</span><br><span class="line">    &lt;key&gt;items&lt;/key&gt;</span><br><span class="line">    &lt;array&gt;</span><br><span class="line">        &lt;dict&gt;</span><br><span class="line">            &lt;key&gt;assets&lt;/key&gt;</span><br><span class="line">            &lt;array&gt;</span><br><span class="line">                &lt;dict&gt;</span><br><span class="line">                    &lt;key&gt;kind&lt;/key&gt;</span><br><span class="line">                    &lt;string&gt;software-package&lt;/string&gt;</span><br><span class="line">                    &lt;key&gt;url&lt;/key&gt;</span><br><span class="line">                    &lt;string&gt;https://10.0.0.12:443/ios/amigo.ipa&lt;/string&gt;;</span><br><span class="line">                &lt;/dict&gt;</span><br><span class="line">                &lt;dict&gt;</span><br><span class="line">                    &lt;key&gt;kind&lt;/key&gt;</span><br><span class="line">                    &lt;string&gt;display-image&lt;/string&gt;</span><br><span class="line">                    &lt;key&gt;url&lt;/key&gt;</span><br><span class="line">                    &lt;string&gt;https://o1wh05aeh.qnssl.com/image/view/app_icons/fe823ec8033348194e09c882d39604b3&lt;/string&gt;;</span><br><span class="line">                &lt;/dict&gt;</span><br><span class="line">                &lt;dict&gt;</span><br><span class="line">                    &lt;key&gt;kind&lt;/key&gt;</span><br><span class="line">                    &lt;string&gt;full-size-image&lt;/string&gt;</span><br><span class="line">                    &lt;key&gt;url&lt;/key&gt;</span><br><span class="line">                    &lt;string&gt;https://o1wh05aeh.qnssl.com/image/view/app_icons/fe823ec8033348194e09c882d39604b3&lt;/string&gt;;</span><br><span class="line">                &lt;/dict&gt;</span><br><span class="line">            &lt;/array&gt;</span><br><span class="line">            &lt;key&gt;metadata&lt;/key&gt;</span><br><span class="line">            &lt;dict&gt;</span><br><span class="line">                &lt;key&gt;bundle-identifier&lt;/key&gt;</span><br><span class="line">                &lt;string&gt;com.xiaolian.amigo&lt;/string&gt;</span><br><span class="line">                &lt;key&gt;bundle-version&lt;/key&gt;</span><br><span class="line">                &lt;string&gt;1.0.0&lt;/string&gt;</span><br><span class="line">                &lt;key&gt;kind&lt;/key&gt;</span><br><span class="line">                &lt;string&gt;software&lt;/string&gt;</span><br><span class="line">                &lt;key&gt;title&lt;/key&gt;</span><br><span class="line">                &lt;string&gt;笑联&lt;/string&gt;</span><br><span class="line">            &lt;/dict&gt;</span><br><span class="line">        &lt;/dict&gt;</span><br><span class="line">    &lt;/array&gt;</span><br><span class="line">&lt;/dict&gt;</span><br><span class="line">&lt;/plist&gt;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2017/04/29/本地app发布下载/" data-id="cjzyuzxdf000zeuzbt90ibvf4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/app发布/">app发布</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS资料/">iOS资料</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-objective-c项目代码规范" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/23/objective-c项目代码规范/" class="article-date">
  <time datetime="2017-01-22T16:00:00.000Z" itemprop="datePublished">2017-01-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/23/objective-c项目代码规范/">iOS内部代码规范</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<p>工程前缀:BB</p>
<h2 id="基础编码规范"><a href="#基础编码规范" class="headerlink" title="基础编码规范"></a>基础编码规范</h2><p>​    标准化输出代码? 用<a href="https://seongbrave.github.io/" target="_blank" rel="noopener">工具</a></p>
<p>​    代码块使用</p>
<p>编码规范简单来说就是为了了保证写出来的代码具备三个原则:可复⽤, 易维护, 可扩展. 这其实也是⾯向对象的基本原则.</p>
<h3 id="常量"><a href="#常量" class="headerlink" title="常量:"></a>常量:</h3><p>常量应该以驼峰法命名，并以相关类名作为前缀，这里如果感觉类名文字太长，我们也可以约定以类名的缩写作为前缀</p>
<p><strong>推荐：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static const NSTimeInterval RACSignalAsynchronousWaitTimeout = 10;</span><br></pre></td></tr></table></figure>
<p><strong>不推荐</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static const NSTimeInterval waitTimeout = 10;</span><br></pre></td></tr></table></figure>
<p>推荐使用常量来代替字符串字面值和数字，这样能够方便复用，而且可以快速修改而不需要查找和替换。常量应该用 static 声明为静态常量，而不要用 #define，除非它明确的作为一个宏来使用</p>
<p><strong>推荐：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">static NSString * const BBRouteParamMatchPattern = @&quot;([^/]+)&quot;;</span><br><span class="line">static const CGFloat BBImageThumbnailHeight = 50.0f;</span><br></pre></td></tr></table></figure>
<p><strong>不推荐</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#define BBRouteParamMatchPattern @&quot;([^/]+)&quot;</span><br><span class="line">#define magicNumber 42</span><br></pre></td></tr></table></figure>
<p>常量应该在头文件中以这样的形式暴露给外部：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FOUNDATION_EXTERN NSString *const BBGlobalApiUrl;</span><br><span class="line">extern NSString *const BBGlobalApiUrl;</span><br></pre></td></tr></table></figure>
<p>并在实现文件中为它赋值:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSString *const BBGlobalApiUrl = @&quot;kapi_url_list&quot;;</span><br></pre></td></tr></table></figure>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><ul>
<li><p>所有的属性特性应该显示的列出来，有助于新⼿理解代码。 </p>
</li>
<li><p><code>*</code>应该跟着属性名字，⽽不是跟在类型后⾯,且和类型保持距离。 </p>
</li>
<li><p>集合作为属性时，标注集合内元素类型.</p>
</li>
<li><p>如果只是单纯的private变量，最好声明在implementation里. 如果是类的public属性，就用property写在.h文件里</p>
</li>
</ul>
<p>属性定义的时候该空格保持距离的,尽量使控件对齐.</p>
<p><strong>推荐</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic, strong)   UIButton    *rightButton;</span><br><span class="line">@property (nonatomic, strong)   UILabel    *priceSaleLabel;</span><br><span class="line">@property (nonatomic, strong)   NSArray&lt;Teacher *&gt; *teacherList;</span><br></pre></td></tr></table></figure>
<p><strong>不推荐</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic,strong)UIButton *rightButton;  </span><br><span class="line">@property (nonatomic,strong)UILabel   *priceSaleLabel; </span><br><span class="line">@property (nonatomic,strong) NSArray *teacherList;</span><br></pre></td></tr></table></figure>
<h4 id="属性名"><a href="#属性名" class="headerlink" title="属性名"></a>属性名</h4><p>常用系统组件和自定义的组件, 在实例化这个对象的时候,定义的名字时保留类名的后缀.</p>
<table>
<thead>
<tr>
<th>常用UI组件</th>
<th>后缀</th>
<th>推荐格式(功能+后缀)</th>
</tr>
</thead>
<tbody>
<tr>
<td>UILabel</td>
<td>Label</td>
<td>nameLabel</td>
</tr>
<tr>
<td>UIView</td>
<td>View</td>
<td>topView</td>
</tr>
<tr>
<td>UIButton</td>
<td>Button</td>
<td>playButton</td>
</tr>
<tr>
<td>…</td>
<td></td>
</tr>
</tbody>
</table>
<p>不推荐 setLab、playBtn等等样式.</p>
<h4 id="私有属性"><a href="#私有属性" class="headerlink" title="私有属性"></a>私有属性</h4><p>私有属性应该定义在类的实现文件.m中，不应该定义在.h文件中申明!!!</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@interface BBCourseDetailAssembleCell ()</span><br><span class="line">@property (nonatomic, strong) UILabel  *roleLabel;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h4 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h4><p>实例化一个对象需要耗费很多资源，或者配置一次就要调用很多配置相关的方法而你又不想弄乱这些方法时，我们需要重写 getter 方法以延迟实例化，而不是在 init 方法里给对象分配内存. </p>
<p><strong>推荐</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (UILabel *)roleLabel &#123;</span><br><span class="line">    if (!_roleLabel) &#123;</span><br><span class="line">        _roleLabel = [[UILabel alloc] init];</span><br><span class="line">        _roleLabel.textColor = kBBLiveDarkTextColor;</span><br><span class="line">        _roleLabel.textAlignment = NSTextAlignmentRight;</span><br><span class="line">        _roleLabel.text = @&quot;详细规则&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    return _roleLabel;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这些属于UI绘制部分的代码,我们实际开发中更关心的是业务逻辑,把这部分代码放入到实现文件中的最后部分,并加上代码块注释区分.</p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><ul>
<li>方法名与方法类型 (-/+)之间应该以空格间隔。方法段之间也应该以空格间隔（以符合 Apple 风格）。参数前应该总是有一个描述性的关键词;</li>
<li>一个⽅法，方法行数尽可能的少(推荐少于50行);</li>
<li>方法分布区: <ul>
<li>life-Cycle、publicMethod、privateMethod、NSNotification、XXDelegate、UIGestureRecognizer、EventResponse、setters/getters 顺序进行行分区域书写。  排序规则,重要的在前,不经常变动的靠后.</li>
<li>对于整个单独的功能模块是可以考虑添加category。 </li>
<li>同⼀区域中的⽅法按照经常:容易易忘记的、常使⽤用的程度顺序进⾏行行排列列</li>
<li>方法参数过多,推荐使用<strong>model</strong>来传参数,尽可能少用 “and”，它不应该用来阐明有多个参数，比如下面的 initWithWidth:height: 这个例子：</li>
</ul>
</li>
</ul>
<p><strong>推荐：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (void)setExampleText:(NSString *)text image:(UIImage *)image;</span><br><span class="line">- (void)sendAction:(SEL)aSelector to:(id)anObject forAllCells:(BOOL)flag;</span><br><span class="line">- (id)viewWithTag:(NSInteger)tag;</span><br><span class="line">- (instancetype)initWithWidth:(CGFloat)width height:(CGFloat)height;</span><br><span class="line">- (void)registerUser(User *)user;</span><br></pre></td></tr></table></figure>
<p><strong>不推荐：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (void)setT:(NSString *)text i:(UIImage *)image;</span><br><span class="line">- (void)sendAction:(SEL)aSelector :(id)anObject :(BOOL)flag;</span><br><span class="line">- (id)taggedView:(NSInteger)tag;</span><br><span class="line">- (instancetype)initWithWidth:(CGFloat)width andHeight:(CGFloat)height;</span><br><span class="line">- (instancetype)initWith:(int)width and:(int)height;  // Never do this.</span><br><span class="line">-(void)registerUserName:(NSString*)userName password:(NSString*)password email:(NSString*)email;</span><br></pre></td></tr></table></figure>
<h3 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h3><p><strong>格式</strong>:png/pdf 格式,尽量使用一种格式, 如果是png格式,不需要保留1x尺寸的图片了.</p>
<p>​    pdf展示不了那么多的色域 简单的,但没有透明度的 icon到是可以选择 pdf.</p>
<p><strong>命名</strong>:对于图片的命名规范</p>
<ul>
<li>通用的:  如back arrow</li>
<li>业务类的:</li>
</ul>
<p>打包的时候有没有分</p>
<h3 id="大括号、空格及换⾏行行规范"><a href="#大括号、空格及换⾏行行规范" class="headerlink" title="大括号、空格及换⾏行行规范"></a>大括号、空格及换⾏行行规范</h3><ul>
<li><p>缩进使用4个空格，确保在Xcode偏好设置来设置。</p>
</li>
<li><p><code>,</code> 的前⾯不应该留有空格， , 后⾯面应该保留⼀个空格。</p>
</li>
<li><p><code>+</code> <code>-</code> <code>*</code> <code>/</code> <code>=</code>的前后都应该保留⼀个空格</p>
<p>推荐:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NSArray *data = @[@&quot;1&quot;, @&quot;2&quot;, @&quot;3&quot;];</span><br><span class="line">NSInteger x = 4 * (5 + 3);</span><br></pre></td></tr></table></figure>
<p>不推荐:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NSArray* data=@[ @&quot;1&quot; , @&quot;2&quot; , @&quot;3&quot; ];</span><br><span class="line">NSInteger x=4*(5+3);</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法及其他⼤括号( 等)，总是在同⼀行语句打开但在新行中关闭。</p>
<p>推荐:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (void)foobar &#123;</span><br><span class="line">    if (user.age &gt; 18) &#123;</span><br><span class="line">        // Do something</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      // Do something</span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不推荐:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- (void)foobar</span><br><span class="line">&#123;</span><br><span class="line">        if (user.age &gt; 18)</span><br><span class="line">        &#123;</span><br><span class="line">          // Do something</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">    // Do something</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在⽅法之间应该有且只有⼀⾏。这样有利利于在视觉上更清晰。在⽅法内部尽量避免空⽩行，如果为了了区分功能，请⽤单⾏注释进行分割(注释可以增加斜杠数量 <code>////</code> 表明功能隔离)。</p>
</li>
<li><p><strong>方法体</strong>内应该避免以冒号对齐的⽅式来调用方法。因为有时⽅法签名可能有3个以上的冒号和冒号对⻬会使代码更加易读。请不要这样做，尽管冒号对齐的⽅法包含代码块，因为Xcode的对⻬方式令它难以辨认。</p>
<p>推荐:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// blocks are easily readable</span><br><span class="line">[UIView animateWithDuration:1.0 animations:^&#123;</span><br><span class="line">  // something</span><br><span class="line">&#125; completion:^(BOOL finished) &#123;</span><br><span class="line">  // something</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>  不推荐:</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// colon-aligning makes the block indentation hard to read</span><br><span class="line">[UIView animateWithDuration:1.0</span><br><span class="line">				 animations:^&#123;</span><br><span class="line">                  // something</span><br><span class="line">                 &#125;</span><br><span class="line">				 completion:^(BOOL finished) &#123;</span><br><span class="line">				  // something</span><br><span class="line">				&#125;];</span><br></pre></td></tr></table></figure>
<h2 id="类命名规范"><a href="#类命名规范" class="headerlink" title="类命名规范"></a>类命名规范</h2><p>每一个类文件名称，我们按照驼峰命名法的规范加上前缀，默认是以公司或事业部缩写作为前缀:  <code>BBxxx</code>,xxx代表类的功能含义,如页面xxController、视图xxView、管理类xxManager等等,功能名字命名需要用与之对应的英文,对自己的翻译没信心的尽量使用翻译工具 如Google和baidu等 ,但严禁类名中出现<code>1</code>、<code>2</code>、<code>3</code>、<code>-</code> 、<code>—</code>、<code>*</code>和<code>-</code>等(数字)符号,但<code>+</code>号除外(分类使用).</p>
<h3 id="基础组件类命名"><a href="#基础组件类命名" class="headerlink" title="基础组件类命名"></a>基础组件类命名</h3><p><strong>公用的基础组件</strong>统一由<code>BB</code>或<code>MST</code>为前缀命名，包括组件名，如<code>BBFoundation</code>。类名遵循BB+用途英文+对象名的模式，如<code>BBCircleProgress</code>。工具类则遵循以下分类 </p>
<table>
<thead>
<tr>
<th>类型</th>
<th>命名规则</th>
</tr>
</thead>
<tbody>
<tr>
<td>单纯工具类</td>
<td>BB+工具用途+Tool/Plugin</td>
</tr>
<tr>
<td>管理性质（包含单例）类</td>
<td>BB+用途+Manager</td>
</tr>
<tr>
<td>存储性质单例类</td>
<td>BB+用途+Defaults</td>
</tr>
<tr>
<td>协调转换（非单例）</td>
<td>BB+用途+Coordinator</td>
</tr>
<tr>
<td>存储类（非单例）</td>
<td>BB+用途+Store</td>
</tr>
<tr>
<td>协议类</td>
<td>BB+用途+Protocol</td>
</tr>
<tr>
<td>自定义类名</td>
<td>BB+类用途+Object</td>
</tr>
<tr>
<td>代理类</td>
<td>BB+用途（或代理关联类类名）+Delegate</td>
</tr>
</tbody>
</table>
<h3 id="APP自有类命名"><a href="#APP自有类命名" class="headerlink" title="APP自有类命名"></a>APP自有类命名</h3><p>教师端以<code>XT</code>为前缀（BBTeacher），学生端以<code>XS</code>为前缀（BBStudent），其余规则参考上述表格。</p>
<blockquote>
<p>在独立的APP中，前缀仅用于APP基类或者只服务于该APP的自有组件，业务页面命名禁止使用前缀。</p>
</blockquote>
<h3 id="业务页面相关类命名"><a href="#业务页面相关类命名" class="headerlink" title="业务页面相关类命名"></a>业务页面相关类命名</h3><p>页面类命名同样遵循可知性，并且，在项目中的页面类，禁止使用任何如<code>BB</code>之类的前缀，与组件分开识别。</p>
<p>命名规则按照：页面模块名+页面英文名（模块主页面可直接使用页面模块名）+Controller（View）</p>
<p>举例：HomeworkListController（View命名依此类推可知）</p>
<h3 id="业务相关类命名"><a href="#业务相关类命名" class="headerlink" title="业务相关类命名"></a>业务相关类命名</h3><p>业务相关类的命名可参考下表</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>命名规则</th>
</tr>
</thead>
<tbody>
<tr>
<td>单纯工具类</td>
<td>模块名+工具用途+Tool/Plugin</td>
</tr>
<tr>
<td>管理性质（包含单例）类</td>
<td>模块名+用途+Manager</td>
</tr>
<tr>
<td>存储性质单例类</td>
<td>模块名+用途+Defaults</td>
</tr>
<tr>
<td>协调转换（非单例）</td>
<td>模块名+用途+Coordinator</td>
</tr>
<tr>
<td>存储类（非单例）</td>
<td>模块名+用途+Store</td>
</tr>
<tr>
<td>协议类</td>
<td>模块名+用途+Protocol</td>
</tr>
<tr>
<td>自定义类名</td>
<td>模块名+类用途+Object</td>
</tr>
<tr>
<td>代理类</td>
<td>模块名+用途（或代理关联类类名）+Delegate</td>
</tr>
<tr>
<td>页面(ViewController)</td>
<td>模块名+用途+Controller</td>
</tr>
<tr>
<td>视图(View)</td>
<td>模块名+用途+View</td>
</tr>
</tbody>
</table>
<p>对于封装的View，需要严格按照封装的View的用途和基类本身进行命名，规则如下：</p>
<p>模块名（隶属于某模块的需要以模块名为前置）+封装控件用途+控件基类类名（View、TableView、CollectionView、Control等等）</p>
<p>例如：DropDownMenuTableView</p>
<h2 id="通知名的定义"><a href="#通知名的定义" class="headerlink" title="通知名的定义"></a>通知名的定义</h2><p>APP名前缀+模块名+动作+Notification</p>
<p><code>BBKeyboardWillShowNotification</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/// .h文件中声明</span><br><span class="line">extern NSNotificationName const BBKeyboardWillShowNotification;</span><br><span class="line">/// .m文件中声明</span><br><span class="line">NSNotificationName const BBKeyboardWillShowNotification = @&quot;BBKeyboardWillShowNotification&quot;;</span><br></pre></td></tr></table></figure>
<h2 id="注释规范"><a href="#注释规范" class="headerlink" title="注释规范"></a>注释规范</h2><ul>
<li>注释的作⽤用:⼀一份规范的代码必定不不能缺少详尽的注释，注释的⽬的:<ul>
<li>⽅便⼯作交接和引导新同事熟悉代码</li>
<li>⽅便⾃己之后回忆代码逻辑</li>
<li>⽅便⽣成文档</li>
<li>便于未来文档插件的介入</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><p>代码分块需要使用<code>#pragma mark -(简单易懂的注释，避免使用复杂难懂的英文或不知所云的中文)</code></p>
<p>代码注释分为几个常见的块:</p>
<p><code>#pragma mark - publicMethod</code>:对外部暴露的方法,即在.h文件中声明的方法名.</p>
<p><code>#pragma mark - privateMethod</code>:类中的私有方法,不对外暴露,内部逻辑方法.</p>
<p><code>#pragma mark - buttonMethod</code>: 按钮点击事件响应.</p>
<p><code>#pragma mark - Notification</code>:通知事件响应.</p>
<p><code>#pragma mark - XXXDelegate</code>:某种代理事件.</p>
<p><code>#pragma mark - UIGestureRecognizer</code>: 手势事件响应.</p>
<p>…</p>
</li>
<li><p>注释分为单⾏行行注释和多⾏行行注释</p>
<ul>
<li><p>对于属性我们使用 三杠 <strong>///</strong> 进行单行注释</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">///姓名</span><br><span class="line">@property (nonatomic, copy)  NSString *name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>对于特殊行//代码块注释的注释的使用 双杠 <strong>//</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//设置⾳音量量</span><br><span class="line">player.volum = 0.5;</span><br><span class="line">if(liveStatus == kLiveStatusEnded)&#123;//直播结束的操作</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">[[[ResourceTask task] post] subscribeNext:^(ResourceTask *task) &#123;//请求之后的处理理</span><br><span class="line"></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
</li>
<li><p>对于⽅法我们使⽤多行注释 <strong>.h文件中</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">*@abstract 初始化⽅法</span><br><span class="line">* @param name 姓名</span><br><span class="line">* @param sex 性别</span><br><span class="line">* @result 返回⼀个初始化实例例 */</span><br><span class="line">- (instancetype)initWithName:(NSString *)name sex:(NSString *)sex;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>实现文件中（.m）仅可使用<code>///</code>作为注释符号，不可使用块注释，头文件中也尽量使用<code>///</code>。块注释的使用场景仅适用于<strong>关键的方法和接口</strong>。</p>
</li>
<li><p>以下三个为特定注释，需要在特定场景下必须加入</p>
<ul>
<li><code>///TODO</code>代码还有业务或者封装未完成，需要注命，以便自己和代码审查者全局搜索。</li>
<li><code>///FIX:(bug编号)</code>用于追溯bug，如果有禅道记录，修复完成后带入禅道的bug号，没有的话，也需要写明bug描述</li>
<li><code>///HAX</code>用于标记难懂的代码，尤其是调用私有API或者是嵌套多层的逻辑</li>
</ul>
</li>
</ul>
<h2 id="git代码提交规范"><a href="#git代码提交规范" class="headerlink" title="git代码提交规范"></a>git代码提交规范</h2><p>不能编译通过的项目代码不准推到远端!!! 每一次commit 备注不能为空!!!  备注尽量详细</p>
<p>修复bug: fix bug xxxx (如果有bugId 最好能带上)</p>
<p>需求开发: xxx功能</p>
<p>上线版本必须打tag, 代码上线后删除对应的dev分支</p>
<h2 id="编码规范细节"><a href="#编码规范细节" class="headerlink" title="编码规范细节"></a>编码规范细节</h2><ul>
<li><p>除值类型属性之外，不允许使用成员变量属性。（会引起block中的循环引用）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">///UIView不是值类型对象，禁止这么声明sampleView，如果要使用，请用@property关键字并使用正确的引用类型。</span><br><span class="line">@interface viewController ()&lt;UIWebViewDelegate&gt; &#123;</span><br><span class="line">	UIView *sampleView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface BBLiveCourseInfoViewController ()</span><br><span class="line">&#123;</span><br><span class="line">    ///介绍cell  用于记录并解决ios10 wkwebview的渲染问题</span><br><span class="line">    BBLiveCourseIntroCell *_IntroCell;</span><br><span class="line">    CGFloat _height;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>debug模式下 勤用NSAssert/NSParameterAssert.</p>
<p>Xcode 已经默认将release环境下的断言取消了, 免除了忘记关闭断言造成的程序不稳定. 所以不用担心 在开发时候大胆使用。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NSAssert([[NSThread currentThread] isMainThread], @&quot;This method must be called on the main thread.&quot;);//第一个参数是条件,如果第一个参数不满足条件,就会记录并打印后面的字符串</span><br><span class="line"></span><br><span class="line">NSParameterAssert(str); //只需要一个参数,如果参数存在程序继续运行,如果参数为空,则程序停止打印日志</span><br></pre></td></tr></table></figure>
<h2 id="资源信息共享"><a href="#资源信息共享" class="headerlink" title="资源信息共享"></a>资源信息共享</h2><p>建立app内用到的,不是特别重要的第三方账号信息共享, 像bugly、蒲公英、QQ和微信等三方账号信息共享. 提高工作协调效率.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2017/01/23/objective-c项目代码规范/" data-id="cjzyuzxe90025euzb31dpry5q" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/代码规范/">代码规范</a></li></ul>

    </footer>
  </div>
  
</article>




  
    <article id="post-iOS基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/23/iOS基础/" class="article-date">
  <time datetime="2016-02-22T16:00:00.000Z" itemprop="datePublished">2016-02-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/23/iOS基础/">iOS基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="weak和assign的区别"><a href="#weak和assign的区别" class="headerlink" title="weak和assign的区别"></a>weak和assign的区别</h3><p><strong>1.</strong>修饰变量类型的区别<br> <strong>weak</strong> 只可以修饰对象。如果修饰基本数据类型，编译器会报错-“Property with ‘weak’ attribute must be of object type”。<br> <strong>assign</strong> 可修饰对象，和基本数据类型。当需要修饰对象类型时，MRC时代使用unsafe_unretained。当然，unsafe_unretained也可能产生野指针，所以它名字是”<strong>unsafe_</strong>”。</p>
<p><strong>2.</strong>是否产生野指针的区别<br> <strong>weak</strong> 不会产生野指针问题。因为weak修饰的对象释放后（引用计数器值为0），指针会自动被置nil，之后再向该对象发消息也不会崩溃。 weak是安全的。<br> <strong>assign</strong> 如果修饰对象，会产生野指针问题；如果修饰基本数据类型则是安全的。修饰的对象释放后，指针不会自动被置空，此时向对象发消息会崩溃。</p>
<h3 id="消息的转发流程-objc-msgForward"><a href="#消息的转发流程-objc-msgForward" class="headerlink" title="消息的转发流程_objc_msgForward"></a>消息的转发流程<code>_objc_msgForward</code></h3><ol>
<li><p>调用resolveInstanceMethod:方法 (或 resolveClassMethod:)。允许用户在此时为该 Class 动态添加实现。如果有实现了，则调用并返回YES，那么重新开始objc_msgSend流程。这一次对象会响应这个选择器，一般是因为它已经调用过class_addMethod。如果仍没实现，继续下面的动作。</p>
</li>
<li><p>调用forwardingTargetForSelector:方法，尝试找到一个能响应该消息的对象。如果获取到，则直接把消息转发给它，返回非 nil 对象。否则返回 nil ，继续下面的动作。注意，这里不要返回 self ，否则会形成死循环。</p>
</li>
<li><p>调用methodSignatureForSelector:方法，尝试获得一个方法签名。如果获取不到，则直接调用doesNotRecognizeSelector抛出异常。如果能获取，则返回非nil：创建一个 NSlnvocation 并传给forwardInvocation:。</p>
</li>
<li><p>调用forwardInvocation:方法，将第3步获取到的方法签名包装成 Invocation 传入，如何处理就在这里面了，并返回非ni。</p>
</li>
<li><p>调用doesNotRecognizeSelector: ，默认的实现是抛出异常。如果第3步没能获得一个方法签名，执行该步骤。</p>
</li>
</ol>
<h3 id="编译与运行时"><a href="#编译与运行时" class="headerlink" title="编译与运行时"></a>编译与运行时</h3><h4 id="编译时"><a href="#编译时" class="headerlink" title="编译时"></a>编译时</h4><p>即编译器对语言的编译阶段，编译时只是对语言进行最基本的检查报错，包括词法分析、语法分析等等，将程序代码翻译成计算机能够识别的语言（例如汇编等），编译通过并不意味着程序就可以成功运行。<br>编译后的类不能添加实例变量,因为编译后的类已经注册在 runtime 中，类结构体中的 <code>objc_ivar_list</code> 实例变量的链表 和 <code>instance_size</code> 实例变量的内存大小已经确定，同时runtime 会调用 <code>class_setIvarLayout</code> 或 <code>class_setWeakIvarLayout</code> 来处理 strong weak 引用。<br>通过analyze 可以分析出一些编译时的问题.</p>
<h4 id="运行时"><a href="#运行时" class="headerlink" title="运行时"></a>运行时</h4><p>即程序通过了编译这一关之后编译好的代码被装载到内存中跑起来的阶段，这个时候会具体对类型进行检查，而不仅仅是对代码的简单扫描分析，此时若出错程序会崩溃。<br>运行时创建的类是可以添加实例变量，调用 class_addIvar 函数。但是得在调用 <code>objc_allocateClassPair</code> 之后，<code>objc_registerClassPair</code> 之前.</p>
<h3 id="runloop和线程有什么关系？"><a href="#runloop和线程有什么关系？" class="headerlink" title="runloop和线程有什么关系？"></a>runloop和线程有什么关系？</h3><p>总的说来,Runloop,如其名,loop表示某种循环,和run放在一起就表示一直在运行着的循环. 实际上,runloop和线程是紧密相连的,可以这样说runloop是为了线程而生,没有线程,它就没有存在的必要. Runloop是线程的基础架构部分,Cocoa和CoreFundation提供了runloop对象方便配置和管理线程的runloop(以下都以Cocoa为例).每个线程,包括程序的主线程(main thread) 都有与之相应的runloop对象.</p>
<p>runloop和线程的关系:</p>
<ol>
<li><p>主线程的runloop默认是启动的. iOS的应用程序里面,程序启动后会有一个如下的main()函数</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int main(int argc, char * argv[]) &#123;</span><br><span class="line">  @autoreleasepool &#123;</span><br><span class="line">    return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重点是UIApplicationMain()函数, 这个方法会为main thread设置一个NSRunloop对象, 这就解释了:为什么我们的应用可以在无人操作的时候休息,需要让它干活的时候又能立马响应.</p>
</li>
<li>对其他线程来说, runloop默认是没有启动,如果你需求更多的线程交互,则可以手动配置和启动,如果线程只是去执行一个长时间的已确定的任务则不需要.</li>
<li>在任何一个Cocoa程序的线程中,都可以通过以下代码来获取到当前线程的runloop. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSRunLoop *runloop = [NSRunLoop currentRunLoop];</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="objc使用什么机制管理对象内存？"><a href="#objc使用什么机制管理对象内存？" class="headerlink" title="objc使用什么机制管理对象内存？"></a>objc使用什么机制管理对象内存？</h3><p>通过 retainCount 的机制来决定对象是否需要释放。 每次 runloop 的时候，都会检查对象的 retainCount，如果retainCount 为 0，说明该对象没有地方需要继续使用了，可以释放掉了。</p>
<h3 id="autorelease"><a href="#autorelease" class="headerlink" title="autorelease"></a>autorelease</h3><p>对象释放分两种情况</p>
<ol>
<li>手动干预释放时机–指定autoreleasepool 就是所谓的：当前作用域大括号结束时释放。</li>
<li>系统自动去释放–不手动指定autoreleasepool</li>
</ol>
<p>Autorelease对象出了作用域之后，会被自动添加到最近一次创建的自动释放池中，并会在当前的 runloop 迭代结束时释放。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://weskhen.xyz/2016/02/23/iOS基础/" data-id="cjzyuzxcw000aeuzbjxgv4w70" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/面试/">面试</a></li></ul>

    </footer>
  </div>
  
</article>




  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/All/">All</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/ReactNative/">ReactNative</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/shell/">shell</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络/">网络</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/MSL/">MSL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSNumberFormatter/">NSNumberFormatter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSProxy/">NSProxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSURLSession/">NSURLSession</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RN-Bug/">RN-Bug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RTT/">RTT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactNative/">ReactNative</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TTL/">TTL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XCode报错/">XCode报错</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/app发布/">app发布</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bundler/">bundler</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS13/">iOS13</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS资料/">iOS资料</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pod/">pod</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代码规范/">代码规范</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/埋点/">埋点</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/暗黑模式/">暗黑模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/私有库/">私有库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/轮播图/">轮播图</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/阿里云日志/">阿里云日志</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试/">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/MSL/" style="font-size: 10px;">MSL</a> <a href="/tags/NSNumberFormatter/" style="font-size: 10px;">NSNumberFormatter</a> <a href="/tags/NSProxy/" style="font-size: 10px;">NSProxy</a> <a href="/tags/NSURLSession/" style="font-size: 10px;">NSURLSession</a> <a href="/tags/RN-Bug/" style="font-size: 10px;">RN-Bug</a> <a href="/tags/RTT/" style="font-size: 10px;">RTT</a> <a href="/tags/ReactNative/" style="font-size: 10px;">ReactNative</a> <a href="/tags/TTL/" style="font-size: 10px;">TTL</a> <a href="/tags/XCode报错/" style="font-size: 10px;">XCode报错</a> <a href="/tags/app发布/" style="font-size: 10px;">app发布</a> <a href="/tags/bundler/" style="font-size: 10px;">bundler</a> <a href="/tags/iOS13/" style="font-size: 10px;">iOS13</a> <a href="/tags/iOS资料/" style="font-size: 10px;">iOS资料</a> <a href="/tags/pod/" style="font-size: 20px;">pod</a> <a href="/tags/代码规范/" style="font-size: 10px;">代码规范</a> <a href="/tags/埋点/" style="font-size: 10px;">埋点</a> <a href="/tags/暗黑模式/" style="font-size: 10px;">暗黑模式</a> <a href="/tags/私有库/" style="font-size: 10px;">私有库</a> <a href="/tags/轮播图/" style="font-size: 10px;">轮播图</a> <a href="/tags/阿里云日志/" style="font-size: 10px;">阿里云日志</a> <a href="/tags/面试/" style="font-size: 10px;">面试</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/08/31/LCalendar日历控件使用/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/07/15/git clone时RPC failed/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/06/24/shell获取函数返回字符串/">shell获取函数返回的字符串</a>
          </li>
        
          <li>
            <a href="/2019/06/06/pod错误日志/">Mac升级到新系统后, 执行pod、bundl命令行报错</a>
          </li>
        
          <li>
            <a href="/2019/06/06/iOS13系统适配/">iOS13 系统适配</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 wesk痕<br>
      <!-- Powered by <a href="http://weskhen.xyz" target="_blank">Wesk</a> -->
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>